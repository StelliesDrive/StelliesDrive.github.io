webpackJsonp(["reader"],{"./client/blocks/reader-combined-card/index.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),a=o(r),n=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/createClass.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/inherits.js"),f=o(p),m=s("./node_modules/prop-types/index.js"),h=o(m),_=s("./node_modules/react/react.js"),g=o(_),b=s("./node_modules/lodash/lodash.js"),v=s("./node_modules/i18n-calypso/index.js"),y=s("./client/components/card/index.jsx"),j=o(y),x=s("./client/reader/route/index.js"),k=s("./client/blocks/reader-avatar/index.jsx"),P=o(k),S=s("./client/blocks/reader-site-stream-link/index.jsx"),w=o(S),I=s("./client/blocks/reader-combined-card/post.jsx"),C=o(I),E=s("./client/lib/feed-stream-store/post-key.js"),R=s("./client/components/data/query-reader-site/index.jsx"),M=o(R),N=s("./client/components/data/query-reader-feed/index.jsx"),L=o(N),T=s("./client/reader/stats.js"),F=s("./client/reader/get-helpers.js"),D=s("./client/reader/follow-button/index.jsx"),H=o(D),A=function(e){function t(){var e,s,o,r;(0,l.default)(this,t);for(var n=arguments.length,i=Array(n),d=0;d<n;d++)i[d]=arguments[d];return s=o=(0,u.default)(this,(e=t.__proto__||(0,a.default)(t)).call.apply(e,[this].concat(i))),o.recordRenderTrack=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.props,t=e.postKey,s=e.posts;(0,T.recordTrack)("calypso_reader_combined_card_render",{blog_id:t.blogId,feed_id:t.feedId,post_count:(0,b.size)(s)})},r=s,(0,u.default)(o,r)}return(0,f.default)(t,e),(0,d.default)(t,[{key:"componentDidMount",value:function(){this.recordRenderTrack()}},{key:"componentWillReceiveProps",value:function(e){this.props.postKey.feedId===e.postKey.feedId&&this.props.postKey.blogId===e.postKey.blogId&&(0,b.size)(this.props.posts)===(0,b.size)(e.posts)||this.recordRenderTrack(e)}},{key:"render",value:function(){var e=this.props,t=e.posts,s=e.site,o=e.feed,r=e.postKey,a=e.selectedPostKey,n=e.onClick,l=e.isDiscover,i=e.translate,d=r.feedId,c=r.blogId,u=(0,b.get)(s,"icon.img"),p=(0,b.get)(o,"image"),f=(0,x.getStreamUrl)(d,c),m=(0,F.getSiteName)({site:s,post:t[0]}),h=function(e){return(0,E.keysAreEqual)((0,E.keyForPost)(e),a)},_=o&&o.URL||s&&s.URL,v=(0,b.filter)(t,function(e){return!(0,b.isEmpty)(e.canonical_media)}).length;return g.default.createElement(j.default,{className:"reader-combined-card"},g.default.createElement("header",{className:"reader-combined-card__header"},g.default.createElement(P.default,{siteIcon:u,feedIcon:p,author:null,preferGravatar:!0,siteUrl:f,isCompact:!0}),g.default.createElement("div",{className:"reader-combined-card__header-details"},g.default.createElement(w.default,{className:"reader-combined-card__site-link",feedId:d,siteId:c},m),g.default.createElement("p",{className:"reader-combined-card__header-post-count"},i("%(count)d posts",{args:{count:t.length}}))),this.props.showFollowButton&&_&&g.default.createElement(H.default,{siteUrl:_,followSource:this.props.followSource})),g.default.createElement("ul",{className:"reader-combined-card__post-list"},t.map(function(e){return g.default.createElement(C.default,{key:"post-"+e.ID,post:e,streamUrl:f,onClick:n,isDiscover:l,isSelected:h(e),showFeaturedAsset:v>0})})),d&&g.default.createElement(L.default,{feedId:+d,includeMeta:!1}),c&&g.default.createElement(M.default,{siteId:+c,includeMeta:!1}))}}]),t}(g.default.Component);A.propTypes={posts:h.default.array.isRequired,site:h.default.object,feed:h.default.object,onClick:h.default.func,isDiscover:h.default.bool,postKey:h.default.object.isRequired,selectedPostKey:h.default.object,showFollowButton:h.default.bool,followSource:h.default.string},A.defaultProps={isDiscover:!1,showFollowButton:!1},t.default=(0,v.localize)(A),e.exports=t.default},"./client/blocks/reader-combined-card/placeholders/post.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/react/react.js"),a=o(r),n=function(){return a.default.createElement("li",{className:"reader-combined-card__post is-placeholder"},a.default.createElement("div",{className:"reader-combined-card__featured-image-wrapper"}),a.default.createElement("div",{className:"reader-combined-card__post-details"},a.default.createElement("h1",{className:"reader-combined-card__post-title"}),a.default.createElement("div",{className:"reader-excerpt is-placeholder"}),a.default.createElement("div",{className:"reader-combined-card__post-author-and-time is-placeholder"},a.default.createElement("div",{className:"reader-combined-card__visit-link-placeholder"}),a.default.createElement("div",{className:"reader-combined-card__timestamp"}))))};t.default=n,e.exports=t.default},"./client/blocks/reader-combined-card/post.jsx":function(e,t,s){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=s("./node_modules/babel-runtime/helpers/extends.js"),n=r(a),l=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),i=r(l),d=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),c=r(d),u=s("./node_modules/babel-runtime/helpers/createClass.js"),p=r(u),f=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),m=r(f),h=s("./node_modules/babel-runtime/helpers/inherits.js"),_=r(h),g=s("./node_modules/prop-types/index.js"),b=r(g),v=s("./node_modules/react/react.js"),y=r(v),j=s("./node_modules/lodash/lodash.js"),x=s("./node_modules/react-dom/index.js"),k=r(x),P=s("./node_modules/component-closest/index.js"),S=r(P),w=s("./node_modules/i18n-calypso/index.js"),I=s("./node_modules/classnames/index.js"),C=r(I),E=s("./client/components/auto-direction/index.jsx"),R=r(E),M=s("./client/components/emojify/index.jsx"),N=r(M),L=s("./client/blocks/reader-excerpt/index.jsx"),T=r(L),F=s("./client/blocks/reader-visit-link/index.jsx"),D=r(F),H=s("./client/blocks/reader-author-link/index.jsx"),A=r(H),O=s("./client/reader/stats.js"),U=o(O),B=s("./client/components/time-since/index.jsx"),K=r(B),q=s("./client/blocks/reader-featured-image/index.jsx"),W=r(q),G=s("./client/blocks/reader-featured-video/index.jsx"),V=r(G),z=s("./client/blocks/reader-combined-card/placeholders/post.jsx"),X=r(z),Y=s("./client/reader/lib/author-name-blacklist/index.js"),$=function(e){function t(){var e,s,o,r;(0,c.default)(this,t);for(var a=arguments.length,n=Array(a),l=0;l<a;l++)n[l]=arguments[l];return s=o=(0,m.default)(this,(e=t.__proto__||(0,i.default)(t)).call.apply(e,[this].concat(n))),o.handleCardClick=function(e){var t=k.default.findDOMNode(o),s=window.getSelection&&window.getSelection();return e.button>0||e.metaKey||e.controlKey||e.shiftKey||e.altKey?void((0,S.default)(e.target,".reader-combined-card__post-title-link",!0,t)&&U.recordPermalinkClick("card_title_with_modifier",o.props.post)):void((0,S.default)(e.target,".ignore-click, [rel~=external]",!0,t)||(0,S.default)(e.target,"a",!0,t)&&(0,S.default)(e.target,".reader-excerpt",!0,t)||s&&s.toString()||e.defaultPrevented||(e.preventDefault(),o.props.onClick(o.props.post)))},r=s,(0,m.default)(o,r)}return(0,_.default)(t,e),(0,p.default)(t,[{key:"render",value:function(){var e=this.props,t=e.post,s=e.streamUrl,o=e.isDiscover,r=e.isSelected,a=!t||"pending"===t._state||"minimal"===t._state;if(a)return y.default.createElement(X.default,null);var l=(0,j.has)(t,"author.name")&&!(0,Y.isAuthorNameBlacklisted)(t.author.name),i=null;t.canonical_media&&"video"===t.canonical_media.mediaType?i=y.default.createElement(V.default,(0,n.default)({},t.canonical_media,{videoEmbed:t.canonical_media,allowPlaying:!1})):t.canonical_media&&(i=y.default.createElement(W.default,{imageWidth:100,imageUrl:t.canonical_media.src,href:t.URL}));var d=function(){(0,O.recordPermalinkClick)("timestamp_combined_card",t)},c=(0,C.default)({"reader-combined-card__post":!0,"is-selected":r,"has-featured-asset":!!i});return y.default.createElement("li",{className:c,onClick:this.handleCardClick},this.props.showFeaturedAsset&&y.default.createElement("div",{className:"reader-combined-card__featured-asset-wrapper"},i),y.default.createElement("div",{className:"reader-combined-card__post-details"},y.default.createElement(R.default,null,y.default.createElement("h1",{className:"reader-combined-card__post-title"},y.default.createElement("a",{className:"reader-combined-card__post-title-link",href:t.URL},y.default.createElement(N.default,null,t.title)))),y.default.createElement(T.default,{post:t,isDiscover:o}),y.default.createElement("div",{className:"reader-combined-card__post-author-and-time ignore-click"},y.default.createElement(D.default,{href:t.URL,iconSize:14},this.props.translate("Visit")),l&&y.default.createElement(A.default,{className:"reader-combined-card__author-link",author:t.author,siteUrl:s,post:t},t.author.name),t.date&&t.URL&&y.default.createElement("span",{className:"reader-combined-card__timestamp"},l&&y.default.createElement("span",null,", "),y.default.createElement("a",{className:"reader-combined-card__timestamp-link",onClick:d,href:t.URL,target:"_blank",rel:"noopener noreferrer"},y.default.createElement(K.default,{date:t.date}))))))}}]),t}(y.default.Component);$.propTypes={post:b.default.object.isRequired,streamUrl:b.default.string,onClick:b.default.func,showFeaturedAsset:b.default.bool},$.defaultProps={showFeaturedAsset:!0},t.default=(0,w.localize)($),e.exports=t.default},"./client/blocks/reader-post-card/blocked.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),a=o(r),n=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/createClass.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/inherits.js"),f=o(p),m=s("./node_modules/prop-types/index.js"),h=o(m),_=s("./node_modules/react/react.js"),g=o(_),b=s("./node_modules/i18n-calypso/index.js"),v=s("./node_modules/react-redux/es/index.js"),y=s("./client/state/reader/site-blocks/actions.js"),j=s("./client/components/card/index.jsx"),x=o(j),k=s("./client/reader/stats.js"),P=s("./client/state/analytics/actions.js"),S=function(e){function t(){var e,s,o,r;(0,l.default)(this,t);for(var n=arguments.length,i=Array(n),d=0;d<n;d++)i[d]=arguments[d];return s=o=(0,u.default)(this,(e=t.__proto__||(0,a.default)(t)).call.apply(e,[this].concat(i))),o.unblock=function(){o.props.bumpStat("reader_actions","unblocked_blog"),o.props.recordGoogleEvent("reader_actions","Clicked Unblock Site"),(0,k.recordTrack)("calypso_reader_unblock_site",{blog_id:o.props.post.site_ID}),o.props.unblockSite(o.props.post.site_ID)},r=s,(0,u.default)(o,r)}return(0,f.default)(t,e),(0,d.default)(t,[{key:"render",value:function(){var e=this.props,t=e.post,s=e.translate;return g.default.createElement(x.default,{className:"reader-post-card is-blocked"},g.default.createElement("p",{className:"reader-post-card__blocked-description"},s("You have blocked %(site_name)s.",{args:{site_name:t.site_name}}),g.default.createElement("a",{onClick:this.unblock,className:"reader-post-card__blocked-undo"},s("Undo?"))))}}]),t}(g.default.Component);S.propTypes={post:h.default.object},t.default=(0,v.connect)(null,{recordGoogleEvent:P.recordGoogleEvent,bumpStat:P.bumpStat,unblockSite:y.unblockSite})((0,b.localize)(S)),e.exports=t.default},"./client/blocks/reader-related-card-v2/index.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=e.post,s=e.site,o=e.onSiteClick,r=e.followSource,a=(0,I.getStreamUrl)(t.feed_ID,t.site_ID),n=s&&s.title||t.site_name,l=(0,h.get)(t,"author.name",""),i=!(0,C.areEqualIgnoringWhitespaceAndCase)(n,l);return u.default.createElement("div",{className:"reader-related-card-v2__meta"},u.default.createElement("a",{href:a,onClick:o,"aria-hidden":"true"},u.default.createElement(P.default,{user:t.author})),u.default.createElement("div",{className:"reader-related-card-v2__byline"},l&&i&&u.default.createElement("span",{className:"reader-related-card-v2__byline-author"},u.default.createElement(T.default,{author:t.author,siteUrl:a,post:t,onClick:o,className:"reader-related-card-v2__link"},l)),u.default.createElement("span",{className:"reader-related-card-v2__byline-site"},u.default.createElement("a",{href:a,onClick:o,className:"reader-related-card-v2__link"},n))),u.default.createElement(w.default,{siteUrl:t.site_URL,followSource:r,railcar:t.railcar}))}function a(){return u.default.createElement("div",{className:"reader-related-card-v2__meta is-placeholder"},u.default.createElement(P.default,{user:null}),u.default.createElement("div",{className:"reader-related-card-v2__byline"},u.default.createElement("span",{className:"reader-related-card-v2__byline-author"},"Author name"),u.default.createElement("span",{className:"reader-related-card-v2__byline-site"},"Site title")))}function n(){return u.default.createElement(x.default,{className:"reader-related-card-v2 is-placeholder"},u.default.createElement(a,null),u.default.createElement("a",{className:"reader-related-card-v2__post reader-related-card-v2__link-block"},u.default.createElement("div",{className:"reader-related-card-v2__featured-image"}),u.default.createElement("div",{className:"reader-related-card-v2__site-info"},u.default.createElement("h1",{className:"reader-related-card-v2__title"},"Title"),u.default.createElement("div",{className:"reader-related-card-v2__excerpt post-excerpt"},"Excerpt"))))}function l(e){var t=e.post,s=e.site,o=e.siteId,a=e.onPostClick,l=void 0===a?h.noop:a,i=e.onSiteClick,c=void 0===i?h.noop:i,p=e.followSource;if(!t||"minimal"===t._state||"pending"===t._state)return u.default.createElement(n,null);var f=(0,I.getPostUrl)(t),_=(0,m.default)("reader-related-card-v2",{"has-thumbnail":!!t.canonical_media,"has-excerpt":t.excerpt&&t.excerpt.length>1}),g=(0,h.partial)(l,t),b=(0,h.partial)(c,t),v=t.canonical_media,j=void 0;return j=v?"video"===v.mediaType?u.default.createElement(R.default,(0,d.default)({},v,{videoEmbed:v,className:"reader-related-card-v2__featured-image",href:f,onThumbnailClick:g,allowPlaying:!1})):u.default.createElement(N.default,{imageUrl:v.src,imageWidth:F,onClick:g,href:f,className:"reader-related-card-v2__featured-image"}):null,u.default.createElement(x.default,{className:_},o&&!s&&u.default.createElement(y.default,{siteId:o}),u.default.createElement(r,{post:t,site:s,onSiteClick:b,followSource:p}),j,u.default.createElement("a",{href:f,className:"reader-related-card-v2__post reader-related-card-v2__link-block",onClick:g},u.default.createElement("div",{className:"reader-related-card-v2__site-info"},u.default.createElement("h1",{className:"reader-related-card-v2__title"},t.title),u.default.createElement("div",{className:"reader-related-card-v2__excerpt post-excerpt"},t.canonical_media?t.short_excerpt:t.better_excerpt_no_html))))}Object.defineProperty(t,"__esModule",{value:!0}),t.LocalizedRelatedPostCard=void 0;var i=s("./node_modules/babel-runtime/helpers/extends.js"),d=o(i);t.RelatedPostCard=l;var c=s("./node_modules/react/react.js"),u=o(c),p=s("./node_modules/react-redux/es/index.js"),f=s("./node_modules/classnames/index.js"),m=o(f),h=s("./node_modules/lodash/lodash.js"),_=s("./node_modules/i18n-calypso/index.js"),g=s("./client/state/reader/posts/selectors.js"),b=s("./client/state/reader/sites/selectors.js"),v=s("./client/components/data/query-reader-site/index.jsx"),y=o(v),j=s("./client/components/card/compact.jsx"),x=o(j),k=s("./client/components/gravatar/index.jsx"),P=o(k),S=s("./client/reader/follow-button/index.jsx"),w=o(S),I=s("./client/reader/route/index.js"),C=s("./client/lib/string/index.js"),E=s("./client/blocks/reader-featured-video/index.jsx"),R=o(E),M=s("./client/blocks/reader-featured-image/index.jsx"),N=o(M),L=s("./client/blocks/reader-author-link/index.jsx"),T=o(L),F=385,D=t.LocalizedRelatedPostCard=(0,_.localize)(l);t.default=(0,p.connect)(function(e,t){var s=t.post,o=(0,g.getPost)(e,s),r=s&&s.site_ID,a=r&&(0,b.getSite)(e,r);return{post:o,site:a,siteId:r}})(D)},"./client/components/card/compact.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){return i.default.createElement(p.default,(0,n.default)({},e,{className:(0,c.default)(e.className,"is-compact")}),e.children)}Object.defineProperty(t,"__esModule",{value:!0});var a=s("./node_modules/babel-runtime/helpers/extends.js"),n=o(a);t.default=r;var l=s("./node_modules/react/react.js"),i=o(l),d=s("./node_modules/classnames/index.js"),c=o(d),u=s("./client/components/card/index.jsx"),p=o(u);e.exports=t.default},"./client/components/data/sync-reader-follows/index.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),a=o(r),n=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/createClass.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/inherits.js"),f=o(p),m=s("./node_modules/react/react.js"),h=s("./node_modules/react-redux/es/index.js"),_=s("./client/state/selectors/should-sync-reader-follows.js"),g=o(_),b=s("./client/state/reader/follows/actions.js"),v=function(e){function t(){return(0,l.default)(this,t),(0,u.default)(this,(t.__proto__||(0,a.default)(t)).apply(this,arguments))}return(0,f.default)(t,e),(0,d.default)(t,[{key:"check",value:function(){this.props.shouldSync&&this.props.requestFollows()}},{key:"componentDidMount",value:function(){this.check()}},{key:"componentDidUpdate",value:function(){this.check()}},{key:"render",value:function(){return null}}]),t}(m.Component);t.default=(0,h.connect)(function(e){return{shouldSync:(0,g.default)(e)}},{requestFollows:b.requestFollows})(v),e.exports=t.default},"./client/components/infinite-list/index.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/core-js/object/keys.js"),a=o(r),n=s("./node_modules/debug/browser.js"),l=o(n),i=s("./node_modules/lodash/lodash.js"),d=s("./node_modules/page/index.js"),c=o(d),u=s("./node_modules/prop-types/index.js"),p=o(u),f=s("./node_modules/react/react.js"),m=o(f),h=s("./node_modules/create-react-class/index.js"),_=o(h),g=s("./node_modules/react-dom/index.js"),b=o(g),v=s("./client/lib/detect-history-navigation/index.js"),y=o(v),j=s("./client/lib/infinite-list/actions.js"),x=o(j),k=s("./client/lib/infinite-list/positions-store.js"),P=o(k),S=s("./client/lib/infinite-list/scroll-store.js"),w=o(S),I=s("./client/components/infinite-list/scroll-helper.js"),C=o(I),E=s("./client/lib/scroll-to/index.js"),R=o(E),M=s("./client/lib/react-smart-set-state/index.js"),N=o(M),L=(0,l.default)("calypso:infinite-list");t.default=(0,_.default)({displayName:"InfiniteList",lastScrollTop:-1,scrollRAFHandle:!1,scrollHelper:null,isScrolling:!1,propTypes:{items:p.default.array.isRequired,fetchingNextPage:p.default.bool.isRequired,lastPage:p.default.bool.isRequired,guessedItemHeight:p.default.number.isRequired,itemsPerRow:p.default.number,fetchNextPage:p.default.func.isRequired,getItemRef:p.default.func.isRequired,renderItem:p.default.func.isRequired,renderLoadingPlaceholders:p.default.func.isRequired,renderTrailingItems:p.default.func,context:p.default.oneOfType([p.default.object,p.default.bool])},getDefaultProps:function(){return{itemsPerRow:1,renderTrailingItems:function(){}}},smartSetState:N.default,componentWillMount:function(){var e=c.default.current,t=void 0,s=void 0;y.default.loadedViaHistory()&&(t=P.default.get(e),s=w.default.get(e)),t&&s&&(L("overriding scrollTop:",s),t.scrollTop=s),this.scrollHelper=new C.default(this.boundsForRef),this.scrollHelper.props=this.props,this._contextLoaded()&&(this._scrollContainer=this.props.context||window,this.scrollHelper.updateContextHeight(this.getCurrentContextHeight())),this.isScrolling=!1,t?L("infinite-list positions loaded from store"):(L("infinite-list positions reset for new list"),t={firstRenderedIndex:0,topPlaceholderHeight:0,lastRenderedIndex:this.scrollHelper.initialLastRenderedIndex(),bottomPlaceholderHeight:0,scrollTop:0}),L("infinite list mounting",t),this.setState(t)},componentDidMount:function(){this._contextLoaded()&&this._setContainerY(this.state.scrollTop),y.default.loadedViaHistory()&&this._overrideHistoryScroll(),L("setting scrollTop:",this.state.scrollTop),this.updateScroll({triggeredByScroll:!1}),this._contextLoaded()&&this._scrollContainer.addEventListener("scroll",this.onScroll)},componentWillReceiveProps:function(e){this.scrollHelper.props=e,this.isScrolling||(this.cancelAnimationFrame(),this.updateScroll({triggeredByScroll:!1})),e.context!==this.props.context&&this._contextLoaded()&&this._scrollContainer.removeEventListener("scroll",this._resetScroll)},componentDidUpdate:function(e){this._contextLoaded()&&(this.props.context!==e.context&&(this._scrollContainer&&this._scrollContainer.removeEventListener("scroll",this.onScroll),this._scrollContainer=this.props.context||window,this._scrollContainer.addEventListener("scroll",this.onScroll),y.default.loadedViaHistory()&&this._overrideHistoryScroll()),this.isScrolling||(this.cancelAnimationFrame(),this.updateScroll({triggeredByScroll:!1})))},reset:function(){this.cancelAnimationFrame(),this.scrollHelper=new C.default(this.boundsForRef),this.scrollHelper.props=this.props,this._contextLoaded()&&(this._scrollContainer=this.props.context||window,this.scrollHelper.updateContextHeight(this.getCurrentContextHeight())),this.isScrolling=!1,this.setState({firstRenderedIndex:0,topPlaceholderHeight:0,lastRenderedIndex:this.scrollHelper.initialLastRenderedIndex(),bottomPlaceholderHeight:0,scrollTop:0})},componentWillUnmount:function(){this._scrollContainer.removeEventListener("scroll",this.onScroll),this._scrollContainer.removeEventListener("scroll",this._resetScroll),this.cancelAnimationFrame()},cancelAnimationFrame:function(){this.scrollRAFHandle&&(window.cancelAnimationFrame(this.scrollRAFHandle),this.scrollRAFHandle=null),this.lastScrollTop=-1},onScroll:function(){this.isScrolling||this.scrollRAFHandle||this.getCurrentScrollTop()===this.lastScrollTop||(this.scrollRAFHandle=window.requestAnimationFrame(this.scrollChecks))},getCurrentContextHeight:function(){var e=this.props.context||window.document.documentElement;return e.clientHeight},getCurrentScrollTop:function(){return this.props.context?(L("getting scrollTop from context"),this.props.context.scrollTop):window.pageYOffset},scrollChecks:function(){return this.isMounted()&&this.getCurrentScrollTop()!==this.lastScrollTop?void this.updateScroll({triggeredByScroll:!0}):void(this.scrollRAFHandle=null)},scrollToTop:function(){var e=this;this.cancelAnimationFrame(),this.isScrolling=!0,this.props.context&&this.props.context!==window?(this.props.context.scrollTop=0,this.updateScroll({triggeredByScroll:!1}),this.isScrolling=!1):(0,R.default)({x:0,y:0,duration:250,onComplete:function(){e.isMounted()&&e.updateScroll({triggeredByScroll:!1}),e.isScrolling=!1}})},updateScroll:function(e){var t=c.default.current,s=void 0;this._contextLoaded()&&(this.lastScrollTop=this.getCurrentScrollTop(),x.default.storeScroll(t,this.lastScrollTop),this.scrollHelper.updateContextHeight(this.getCurrentContextHeight()),this.scrollHelper.scrollPosition=this.lastScrollTop,this.scrollHelper.triggeredByScroll=e.triggeredByScroll,this.scrollHelper.updatePlaceholderDimensions(),this.scrollHelper.scrollChecks(this.state),this.scrollHelper.stateUpdated&&(s={firstRenderedIndex:this.scrollHelper.firstRenderedIndex,topPlaceholderHeight:this.scrollHelper.topPlaceholderHeight,lastRenderedIndex:this.scrollHelper.lastRenderedIndex,bottomPlaceholderHeight:this.scrollHelper.bottomPlaceholderHeight,scrollTop:this.lastScrollTop},this.lastScrollTop=-1,L("new scroll positions",s,this.state),this.smartSetState(s),x.default.storePositions(t,s)),this.scrollRAFHandle=window.requestAnimationFrame(this.scrollChecks))},boundsForRef:function(e){return e in this.refs?b.default.findDOMNode(this.refs[e]).getBoundingClientRect():null},getVisibleItemIndexes:function(e){var t=b.default.findDOMNode(this),s=[],o=this.state.firstRenderedIndex,r=this.state.lastRenderedIndex,a=e&&e.offsetTop?e.offsetTop:0,n=void 0,l=void 0,i=void 0,d=void 0,c=e&&e.offsetBottom?e.offsetBottom:0;if(c=c||0,r>-1)for(i=t.children,d=1;d<i.length-1;d++)l=t.children[d].getBoundingClientRect(),n=window.innerHeight||document.documentElement.clientHeight,(l.top<0&&Math.abs(l.top)<l.height-a||l.top>0&&l.top<n-c)&&s.push({index:o+d-1,bounds:l});return s},render:function(){var e=(0,i.omit)(this.props,(0,a.default)(this.constructor.propTypes)),t="infinite-list__spacer",s=void 0,o=this.state.lastRenderedIndex,r=[];for((o===-1||o>this.props.items.length-1)&&(L("resetting lastRenderedIndex, currently at %s, %d items",o,this.props.items.length),o=Math.min(this.state.firstRenderedIndex+this.scrollHelper.initialLastRenderedIndex(),this.props.items.length-1),L("reset lastRenderedIndex to %s",o)),L("rendering %d to %d",this.state.firstRenderedIndex,o),s=this.state.firstRenderedIndex;s<=o;s++)r.push(this.props.renderItem(this.props.items[s],s));return this.props.fetchingNextPage&&(r=r.concat(this.props.renderLoadingPlaceholders())),m.default.createElement("div",e,m.default.createElement("div",{ref:"topPlaceholder",className:t,style:{height:this.state.topPlaceholderHeight}}),r,this.props.renderTrailingItems(),m.default.createElement("div",{ref:"bottomPlaceholder",className:t,style:{height:this.state.bottomPlaceholderHeight}}))},_setContainerY:function(e){return this.props.context&&this.props.context!==window?void(this.props.context.scrollTop=e):void window.scrollTo(0,e)},_overrideHistoryScroll:function(){this._contextLoaded()&&this._scrollContainer.addEventListener("scroll",this._resetScroll)},_resetScroll:function(e){var t=this.state.scrollTop;this._contextLoaded()&&(L("history setting scroll position:",e),this._setContainerY(t),this._scrollContainer.removeEventListener("scroll",this._resetScroll),L("override scroll position from HTML5 history popstate:",t))},_contextLoaded:function(){return this.props.context||this.props.context===!1||!("context"in this.props)}}),e.exports=t.default},"./client/components/infinite-list/scroll-helper.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),a=o(r),n=s("./node_modules/babel-runtime/helpers/createClass.js"),l=o(n),i=s("./node_modules/debug/browser.js"),d=o(i),c=(0,d.default)("calypso:infinite-list:helper"),u=function(){function e(t){(0,a.default)(this,e),this.boundsForRef=t,this.itemHeights={},this.contextHeight=null,this.topHideLevelHard=null,this.topHideLevelSoft=null,this.bottomHideLevelHard=null,this.bottomHideLevelSoft=null,this.bottomHideLevelUltraSoft=null,this.props=null,this.scrollPosition=null,this.containerTop=null,this.topPlaceholderHeight=null,this.bottomPlaceholderHeight=null,this.containerBottom=null,this.stateUpdated=null,this.firstRenderedIndex=null,this.lastRenderedIndex=null}return(0,l.default)(e,[{key:"storedItemHeight",value:function(e){var t=this.props.guessedItemHeight;return e in this.itemHeights&&(t=this.itemHeights[e]),t}},{key:"forEachInRow",value:function(e,t,s){if("function"==typeof t){s&&(t=t.bind(s));for(var o=e-e%this.props.itemsPerRow,r=Math.min(o+this.props.itemsPerRow,this.props.items.length)-1,a=o;a<=r;a++)t(this.props.items[a],a)}}},{key:"storeRowItemHeights",value:function(e,t){this.forEachInRow(t,function(t){var s=this.props.getItemRef(t),o=this.boundsForRef(s),r=void 0;r=o?"bottom"===e?this.containerBottom-this.bottomPlaceholderHeight-o.top:o.bottom-(this.containerTop+this.topPlaceholderHeight):this.props.guessedItemHeight,this.itemHeights[s]=r},this)}},{key:"deleteRowItemHeights",value:function(e){var t=this;this.forEachInRow(e,function(e){var s=t.props.getItemRef(e);delete t.itemHeights[s]},this)}},{key:"getRowHeight",value:function(e){var t=this,s=0;return this.forEachInRow(e,function(e){var o=t.props.getItemRef(e),r=t.storedItemHeight(o);s=Math.max(s,r)},this),s}},{key:"updateContextHeight",value:function(e){this.contextHeight!==e&&(this.contextHeight=e,this.topHideLevelHard=Math.min(-1*e,-5*this.props.guessedItemHeight),this.topHideLevelSoft=Math.min(-2*e,-10*this.props.guessedItemHeight),this.bottomHideLevelHard=e+Math.max(e,5*this.props.guessedItemHeight),this.bottomHideLevelSoft=e+Math.max(2*e,10*this.props.guessedItemHeight),this.bottomHideLevelUltraSoft=e+Math.max(3*e,15*this.props.guessedItemHeight))}},{key:"initialLastRenderedIndex",value:function(){return Math.min(this.props.items.length-1,Math.floor(this.bottomHideLevelSoft/this.props.guessedItemHeight)-1)}},{key:"updatePlaceholderDimensions",value:function(){var e=this.boundsForRef("topPlaceholder"),t=this.boundsForRef("bottomPlaceholder");this.topPlaceholderHeight=e.height,this.containerTop=e.top,this.bottomPlaceholderHeight=t.height,this.containerBottom=t.bottom}},{key:"scrollChecks",value:function(e){this.reset(e),this.adjustLastRenderedIndex(),this.shouldHideItemsAbove()?this.hideItemsAbove():this.shouldShowItemsAbove()&&this.showItemsAbove(),this.shouldHideItemsBelow()?this.hideItemsBelow():this.shouldShowItemsBelow()&&this.showItemsBelow(),this.shouldLoadNextPage()&&this.loadNextPage()}},{key:"reset",value:function(e){this.stateUpdated=!1,this.firstRenderedIndex=e.firstRenderedIndex,this.lastRenderedIndex=e.lastRenderedIndex}},{key:"adjustLastRenderedIndex",value:function(){var e=this.initialLastRenderedIndex(),t=this.lastRenderedIndex||0,s=this.firstRenderedIndex||0,o=this.props.items.length,r=t;0===o&&(r=-1),t>=o&&(r=Math.min(s+e,o-1)),r===-1&&o>0&&0===s&&(r=e),r!==this.lastRenderedIndex&&(this.stateUpdated=!0,this.lastRenderedIndex=r)}},{key:"shouldHideItemsAbove",value:function(){return this.containerTop+this.topPlaceholderHeight<this.topHideLevelSoft}},{key:"hideItemsAbove",value:function(){for(var e=void 0,t=void 0;this.firstRenderedIndex<this.props.items.length;){if(this.storeRowItemHeights("top",this.firstRenderedIndex),e=this.getRowHeight(this.firstRenderedIndex),t=this.containerTop+this.topPlaceholderHeight+e,t>this.topHideLevelHard){this.deleteRowItemHeights(this.firstRenderedIndex);break}this.topPlaceholderHeight+=e,this.firstRenderedIndex+=this.props.itemsPerRow,this.stateUpdated=!0,c("hiding top item",e,this.topPlaceholderHeight)}}},{key:"shouldShowItemsAbove",value:function(){return this.containerTop+this.topPlaceholderHeight>this.topHideLevelHard}},{key:"showItemsAbove",value:function(){for(var e=void 0,t=void 0;this.firstRenderedIndex>0&&(e=this.getRowHeight(this.firstRenderedIndex-this.props.itemsPerRow),t=this.containerTop+this.topPlaceholderHeight-e,!(t<this.topHideLevelSoft));)this.deleteRowItemHeights(this.firstRenderedIndex-this.props.itemsPerRow),this.firstRenderedIndex-=this.props.itemsPerRow,this.firstRenderedIndex=Math.max(0,this.firstRenderedIndex),this.firstRenderedIndex<=0?this.topPlaceholderHeight=0:this.topPlaceholderHeight=Math.max(0,this.topPlaceholderHeight-e),this.stateUpdated=!0,c("showing top item",e,this.topPlaceholderHeight)}},{key:"shouldHideItemsBelow",value:function(){var e=this.containerBottom-this.bottomPlaceholderHeight;return e>this.bottomHideLevelUltraSoft;
}},{key:"hideItemsBelow",value:function(){for(var e=void 0,t=void 0;this.lastRenderedIndex>=0;){if(this.storeRowItemHeights("bottom",this.lastRenderedIndex),t=this.getRowHeight(this.lastRenderedIndex),e=this.containerBottom-this.bottomPlaceholderHeight-t,e<this.bottomHideLevelHard){this.deleteRowItemHeights(this.lastRenderedIndex);break}this.bottomPlaceholderHeight+=t,this.lastRenderedIndex-=this.props.itemsPerRow,this.stateUpdated=!0,c("hiding bottom item",t,this.bottomPlaceholderHeight)}}},{key:"shouldShowItemsBelow",value:function(){var e=this.containerBottom-this.bottomPlaceholderHeight;return e<this.bottomHideLevelHard}},{key:"showItemsBelow",value:function(){for(var e=void 0,t=void 0,s=void 0;this.lastRenderedIndex<this.props.items.length-1&&(e=this.getRowHeight(this.lastRenderedIndex+this.props.itemsPerRow),s=this.containerBottom-this.bottomPlaceholderHeight,t=s+e,!(t>this.bottomHideLevelSoft&&s>this.bottomHideLevelHard));)this.deleteRowItemHeights(this.lastRenderedIndex+this.props.itemsPerRow),this.bottomPlaceholderHeight-e<0?(this.containerBottom+=e-this.bottomPlaceholderHeight,this.bottomPlaceholderHeight=0):this.bottomPlaceholderHeight-=e,this.lastRenderedIndex+=this.props.itemsPerRow,this.lastRenderedIndex=Math.min(this.lastRenderedIndex,this.props.items.length-1),this.lastRenderedIndex>=this.props.items.length-1&&(this.bottomPlaceholderHeight=0),this.stateUpdated=!0,c("showing bottom item",e,this.bottomPlaceholderHeight)}},{key:"shouldLoadNextPage",value:function(){return!this.props.fetchingNextPage&&!this.props.lastPage&&(0===this.bottomPlaceholderHeight&&this.containerBottom<this.bottomHideLevelHard)}},{key:"loadNextPage",value:function(){var e=this,t=this.triggeredByScroll;c("fetching next page",this.containerBottom,this.bottomPlaceholderHeight),this.scrollPosition>this.contextHeight&&(t=!0),setTimeout(function(){return!e.props.fetchingNextPage&&!e.props.lastPage&&void e.props.fetchNextPage({triggeredByScroll:t})},0)}}]),e}();t.default=u,e.exports=t.default},"./client/components/list-end/index.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(){return l}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var a=s("./node_modules/react/react.js"),n=o(a),l=n.default.createElement("div",{className:"list-end"});e.exports=t.default},"./client/components/mobile-back-to-sidebar/index.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),a=o(r),n=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/createClass.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/inherits.js"),f=o(p),m=s("./node_modules/react/react.js"),h=o(m),_=s("./node_modules/react-redux/es/index.js"),g=s("./client/state/ui/layout-focus/actions.js"),b=function(e){function t(){var e,s,o,r;(0,l.default)(this,t);for(var n=arguments.length,i=Array(n),d=0;d<n;d++)i[d]=arguments[d];return s=o=(0,u.default)(this,(e=t.__proto__||(0,a.default)(t)).call.apply(e,[this].concat(i))),o.toggleSidebar=function(e){e.preventDefault(),o.props.setLayoutFocus("sidebar")},r=s,(0,u.default)(o,r)}return(0,f.default)(t,e),(0,d.default)(t,[{key:"render",value:function(){return h.default.createElement("div",{className:"mobile-back-to-sidebar",onClick:this.toggleSidebar},h.default.createElement("svg",{className:"gridicon gridicon-back-arrow mobile-back-to-sidebar__icon",height:"24",width:"24",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},h.default.createElement("g",null,h.default.createElement("path",{d:"M8.886 4L7 5.886 13.114 12 7 18.114 8.886 20l8-8"}))),h.default.createElement("span",{className:"mobile-back-to-sidebar__content"},this.props.children))}}]),t}(h.default.Component);t.default=(0,_.connect)(null,{setLayoutFocus:g.setLayoutFocus})(b),e.exports=t.default},"./client/components/reader-main/index.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/helpers/objectWithoutProperties.js"),a=o(r),n=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/createClass.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),f=o(p),m=s("./node_modules/babel-runtime/helpers/inherits.js"),h=o(m),_=s("./node_modules/react/react.js"),g=o(_),b=s("./client/components/main/index.jsx"),v=o(b),y=s("./client/components/data/sync-reader-follows/index.js"),j=o(y),x=0,k=function(e){e?document.querySelector("body").classList.add("is-reader-page"):0===x&&document.querySelector("body").classList.remove("is-reader-page")},P=function(e){function t(){return(0,d.default)(this,t),(0,f.default)(this,(t.__proto__||(0,l.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,u.default)(t,[{key:"componentWillMount",value:function(){x++,k(!0)}},{key:"componentWillUnmount",value:function(){x--,k(!1)}},{key:"render",value:function(){var e=this.props,t=e.children,s=(0,a.default)(e,["children"]);return g.default.createElement(v.default,s,g.default.createElement(j.default,{key:"syncReaderFollows"}),t)}}]),t}(g.default.Component);t.default=P,e.exports=t.default},"./client/components/section-nav/index.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),a=o(r),n=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/createClass.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/inherits.js"),f=o(p),m=s("./node_modules/react/react.js"),h=o(m),_=s("./node_modules/prop-types/index.js"),g=o(_),b=s("./node_modules/classnames/index.js"),v=o(b),y=s("./node_modules/lodash/lodash.js"),j=s("./client/my-sites/comments/comment-navigation/comment-navigation-tab.jsx"),x=o(j),k=s("./client/components/section-nav/tabs.jsx"),P=o(k),S=s("./client/components/section-nav/item.jsx"),w=o(S),I=s("./client/components/search/index.jsx"),C=o(I),E=function(e){function t(){var e,s,o,r;(0,l.default)(this,t);for(var n=arguments.length,i=Array(n),d=0;d<n;d++)i[d]=arguments[d];return s=o=(0,u.default)(this,(e=t.__proto__||(0,a.default)(t)).call.apply(e,[this].concat(i))),R.call(o),r=s,(0,u.default)(o,r)}return(0,f.default)(t,e),(0,d.default)(t,[{key:"componentWillMount",value:function(){this.checkForSiblingControls(this.props.children)}},{key:"componentWillReceiveProps",value:function(e){(0,y.isEqual)(this.props,e)||(this.checkForSiblingControls(e.children),this.hasSiblingControls||this.closeMobilePanel())}},{key:"render",value:function(){var e=this.getChildren(),t=void 0;return e?(t=(0,v.default)({"section-nav":!0,"is-open":this.state.mobileOpen,"has-pinned-items":this.hasPinnedSearch||this.props.hasPinnedItems},this.props.className),h.default.createElement("div",{className:t},this.renderDropdown(),h.default.createElement("div",{className:"section-nav__panel"},e))):(t=(0,v.default)({"section-nav":!0,"is-empty":!0},this.props.className),h.default.createElement("div",{className:t},h.default.createElement("div",{className:"section-nav__panel"},h.default.createElement(w.default,null))))}}]),t}(m.Component);E.propTypes={selectedText:g.default.node,selectedCount:g.default.number,hasPinnedItems:g.default.bool,onMobileNavPanelOpen:g.default.func,className:g.default.string,allowDropdown:g.default.bool},E.defaultProps={onMobileNavPanelOpen:function(){},allowDropdown:!0};var R=function(){var e=this;this.state={mobileOpen:!1},this.renderDropdown=function(){return e.props.allowDropdown?h.default.createElement("div",{className:"section-nav__mobile-header",onClick:e.toggleMobileOpenState},h.default.createElement("span",{className:"section-nav__mobile-header-text"},e.props.selectedText)):h.default.createElement("div",null)},this.getChildren=function(){return h.default.Children.map(e.props.children,function(e){var t={hasSiblingControls:this.hasSiblingControls,closeSectionNavMobilePanel:this.closeMobilePanel};return e?(e.type!==P.default||e.props.selectedText||"string"!=typeof this.props.selectedText||(t.selectedText=this.props.selectedText),e.type===P.default&&this.props.selectedCount&&(t.selectedCount=this.props.selectedCount),e.type===C.default&&(e.props.pinned&&(this.hasPinnedSearch=!0),t.onSearch=this.generateOnSearch(e.props.onSearch)),h.default.cloneElement(e,t)):null}.bind(e))},this.closeMobilePanel=function(){window.innerWidth<480&&e.state.mobileOpen&&e.setState({mobileOpen:!1})},this.toggleMobileOpenState=function(){var t=!e.state.mobileOpen;e.setState({mobileOpen:t}),t&&e.props.onMobileNavPanelOpen()},this.generateOnSearch=function(t){return function(){t.apply(void 0,arguments),e.closeMobilePanel()}},this.checkForSiblingControls=function(t){e.hasSiblingControls=!1;var s=[C.default,x.default];h.default.Children.forEach(t,function(e,t){t&&e&&!(0,y.includes)(s,e.type)&&(this.hasSiblingControls=!0)}.bind(e))}};t.default=E,e.exports=t.default},"./client/components/section-nav/item.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),a=o(r),n=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/createClass.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/inherits.js"),f=o(p),m=s("./node_modules/react/react.js"),h=o(m),_=s("./node_modules/prop-types/index.js"),g=o(_),b=s("./node_modules/classnames/index.js"),v=o(b),y=s("./client/components/count/index.jsx"),j=o(y),x=s("./client/sections-preload.js"),k=function(e){function t(){var e,s,o,r;(0,l.default)(this,t);for(var n=arguments.length,i=Array(n),d=0;d<n;d++)i[d]=arguments[d];return s=o=(0,u.default)(this,(e=t.__proto__||(0,a.default)(t)).call.apply(e,[this].concat(i))),o._preloaded=!1,o.preload=function(){!o._preloaded&&o.props.preloadSectionName&&(o._preloaded=!0,(0,x.preload)(o.props.preloadSectionName))},r=s,(0,u.default)(o,r)}return(0,f.default)(t,e),(0,d.default)(t,[{key:"render",value:function(){var e=this.props.itemType?this.props.itemType:"tab",t={"is-selected":this.props.selected,"is-external":this.props.isExternalLink};t["section-nav-"+e]=!0;var s=(0,v.default)(this.props.className,t),o=void 0,r=void 0;return this.props.isExternalLink&&(o="_blank"),this.props.disabled||(r=this.props.onClick),h.default.createElement("li",{className:s},h.default.createElement("a",{href:this.props.path,target:o,className:"section-nav-"+e+"__link",onClick:r,onMouseEnter:this.preload,tabIndex:this.props.tabIndex||0,"aria-selected":this.props.selected,disabled:this.props.disabled,role:"menuitem",rel:this.props.isExternalLink?"external":null},h.default.createElement("span",{className:"section-nav-"+e+"__text"},this.props.children,"number"==typeof this.props.count&&h.default.createElement(j.default,{count:this.props.count}))))}}]),t}(m.PureComponent);k.propTypes={itemType:g.default.string,path:g.default.string,selected:g.default.bool,tabIndex:g.default.number,onClick:g.default.func,isExternalLink:g.default.bool,disabled:g.default.bool,count:g.default.oneOfType([g.default.number,g.default.bool]),className:g.default.string,preloadSectionName:g.default.string},t.default=k,e.exports=t.default},"./client/components/section-nav/tabs.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/helpers/extends.js"),a=o(r),n=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/createClass.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),f=o(p),m=s("./node_modules/babel-runtime/helpers/inherits.js"),h=o(m),_=s("./node_modules/react/react.js"),g=o(_),b=s("./node_modules/react-dom/index.js"),v=o(b),y=s("./node_modules/prop-types/index.js"),j=o(y),x=s("./node_modules/classnames/index.js"),k=o(x),P=s("./node_modules/lodash/lodash.js"),S=s("./client/components/select-dropdown/item.jsx"),w=o(S),I=s("./client/components/select-dropdown/index.jsx"),C=o(I),E=s("./client/lib/viewport/index.js"),R=o(E),M=480,N=function(e){function t(){var e,s,o,r;(0,d.default)(this,t);for(var n=arguments.length,i=Array(n),c=0;c<n;c++)i[c]=arguments[c];return s=o=(0,f.default)(this,(e=t.__proto__||(0,l.default)(t)).call.apply(e,[this].concat(i))),o.state={isDropdown:!1},o.getTabWidths=function(){var e=0;g.default.Children.forEach(o.props.children,function(t,s){if(t){var o=v.default.findDOMNode(this.refs["tab-"+s]).offsetWidth;e+=o}}.bind(o)),o.tabsWidth=Math.max(e,o.tabsWidth||0)},o.getDropdown=function(){var e=g.default.Children.map(o.props.children,function(e,t){return e?g.default.createElement(w.default,(0,a.default)({},e.props,{key:"navTabsDropdown-"+t}),e.props.children):null});return g.default.createElement(C.default,{className:"section-nav-tabs__dropdown",selectedText:o.props.selectedText,selectedCount:o.props.selectedCount},e)},o.setDropdown=function(){var e=void 0;if(window.innerWidth>M){if(!o.refs.navGroup)return;e=o.refs.navGroup.offsetWidth,o.getTabWidths(),e<=o.tabsWidth&&!o.state.isDropdown?o.setState({isDropdown:!0}):e>o.tabsWidth&&o.state.isDropdown&&o.setState({isDropdown:!1})}else window.innerWidth<=M&&o.state.isDropdown&&o.setState({isDropdown:!1})},o.keyHandler=function(e){switch(e.keyCode){case 32:case 13:e.preventDefault(),document.activeElement.click()}},r=s,(0,f.default)(o,r)}return(0,h.default)(t,e),(0,u.default)(t,[{key:"componentDidMount",value:function(){this.setDropdown(),this.debouncedAfterResize=(0,P.debounce)(this.setDropdown,300),window.addEventListener("resize",this.debouncedAfterResize)}},{key:"componentDidUpdate",value:function(){this.setDropdown()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.debouncedAfterResize)}},{key:"render",value:function(){var e=g.default.Children.map(this.props.children,function(e,t){return e&&g.default.cloneElement(e,{ref:"tab-"+t})}),t=(0,k.default)({"section-nav-tabs":!0,"is-dropdown":this.state.isDropdown,"is-open":this.state.isDropdownOpen,"has-siblings":this.props.hasSiblingControls}),s=R.default.getWindowInnerWidth();return g.default.createElement("div",{className:"section-nav-group",ref:"navGroup"},g.default.createElement("div",{className:t},this.props.label&&g.default.createElement("h6",{className:"section-nav-group__label"},this.props.label),g.default.createElement("ul",{className:"section-nav-tabs__list",role:"menu",onKeyDown:this.keyHandler},e),this.state.isDropdown&&s>M&&this.getDropdown()))}}]),t}(_.Component);N.propTypes={selectedText:j.default.string,selectedCount:j.default.number,label:j.default.string,hasSiblingControls:j.default.bool},N.defaultProps={hasSiblingControls:!1},t.default=N,e.exports=t.default},"./client/lib/feed-lookup/index.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){return"feed-lookup-"+e}function a(e){var t=r(e);return(0,c.isRequestInflight)(t)?f.get(e):p.default.undocumented().discoverFeed({url:e})}function n(e){var t=f.get(e);return t?t:(t=a(e).then(function(e){if(!(0,l.isEmpty)(e.feeds)){var t=(0,l.head)(e.feeds);if(!(0,l.isEmpty)(t.feed_ID))return t.feed_ID}}),f.set(e,t),t)}Object.defineProperty(t,"__esModule",{value:!0});var l=s("./node_modules/lodash/lodash.js"),i=s("./node_modules/lru/index.js"),d=o(i),c=s("./client/lib/inflight/index.js"),u=s("./client/lib/wp/browser.js"),p=o(u),f=new d.default(10);t.default=n,e.exports=t.default},"./client/lib/feed-post-store/display-types.js":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={UNCLASSIFIED:0,PHOTO_ONLY:1,LARGE_BANNER:2,ONE_LINER:4,LANDSCAPE_BANNER:8,PORTRAIT_BANNER:16,GALLERY:32,VIDEO:64,THUMBNAIL:128,FEATURED_VIDEO:512,X_POST:1024},e.exports=t.default},"./client/lib/feed-stream-store/actions.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){var t={orderBy:e.orderBy,number:e.perPage,meta:"post,discover_original_post"},s=e.getLastItemWithDate();return s?t.before=s:(t.number=4,e.startDate&&(t.before=e.startDate)),t}function a(e){var t=P.default.get(e);if(t&&!t.isLastPage()&&!t.isFetchingNextPage()&&!t.hasRecentError()){v.default.handleViewAction({type:y.action.FETCH_NEXT_PAGE,id:e});var s=r(t);t.onNextPageFetch(s),t.fetcher(s,n.bind(null,t.id))}}function n(e,t,s){!t&&s&&s.posts&&(0,g.forEach)(s.posts,function(e){e&&(0,g.get)(e,"meta.data.discover_original_post")&&x.default.receivePost(null,e.meta.data.discover_original_post,{blogId:e.meta.data.discover_original_post.site_ID,postId:e.meta.data.discover_original_post.ID}),e&&(0,g.get)(e,"meta.data.post")?x.default.receivePost(null,e.meta.data.post,{feedId:e.feed_ID,postId:e.ID}):e&&e.feed_ID&&e.feed_item_ID?x.default.receivePost(null,e,{feedId:e.feed_ID,postId:e.feed_item_ID}):e&&e.site_ID&&x.default.receivePost(null,e,{blogId:e.site_ID,postId:e.ID}),e.comments&&(0,I.reduxDispatch)({type:C.COMMENTS_RECEIVE,siteId:e.site_ID,postId:e.ID,comments:e.comments})}),v.default.handleServerAction({type:y.action.RECEIVE_PAGE,id:e,error:t,data:s})}function l(e,t,s){!t&&s&&s.posts&&(0,g.forEach)(s.posts,function(e){e.comments&&(0,I.reduxDispatch)({type:C.COMMENTS_RECEIVE,siteId:e.site_ID,postId:e.ID,comments:e.comments})}),v.default.handleServerAction({type:y.action.RECEIVE_UPDATES,id:e,error:t,data:s})}function i(e){v.default.handleViewAction({type:y.action.SHOW_UPDATES,id:e})}function d(e){v.default.handleViewAction({type:y.action.SELECT_NEXT_ITEM,id:e})}function c(e){v.default.handleViewAction({type:y.action.SELECT_PREV_ITEM,id:e})}function u(e){v.default.handleViewAction({type:y.action.SELECT_FIRST_ITEM,id:e})}function p(e,t){v.default.handleViewAction({type:y.action.SELECT_ITEM,id:e,postKey:t})}function f(e,t){var s=P.default.get(e);if(s){v.default.handleViewAction({type:y.action.FILL_GAP,id:e,gap:t});var o={before:t.to.toISOString(),after:t.from.toISOString(),number:s.gapFillCount,orderBy:s.orderBy};s.onGapFetch(o),s.fetcher(o,m.bind(null,s.id,t))}}function m(e,t,s,o){v.default.handleServerAction({type:y.action.RECEIVE_GAP,id:e,gap:t,error:s,data:o})}function h(e,t){v.default.handleViewAction({type:y.action.DISMISS_FEED_STREAM_POST,postKey:{blogId:t.site_ID,postId:t.ID},id:e}),w.default.undocumented().me().dismissSite(t.site_ID)}function _(e){v.default.handleViewAction({type:y.action.SHUFFLE_POSTS,id:e})}Object.defineProperty(t,"__esModule",{value:!0}),t.fetchNextPage=a,t.receivePage=n,t.receiveUpdates=l,t.showUpdates=i,t.selectNextItem=d,t.selectPrevItem=c,t.selectFirstItem=u,t.selectItem=p,t.fillGap=f,t.receiveGap=m,t.dismissPost=h,t.shufflePosts=_;var g=s("./node_modules/lodash/lodash.js"),b=s("./client/dispatcher/index.js"),v=o(b),y=s("./client/lib/feed-stream-store/constants.js"),j=s("./client/lib/feed-post-store/actions.js"),x=o(j),k=s("./client/lib/feed-stream-store/feed-stream-cache.js"),P=o(k),S=s("./client/lib/wp/browser.js"),w=o(S),I=s("./client/lib/redux-bridge/index.js"),C=s("./client/state/action-types.js")},"./client/lib/feed-stream-store/feed-stream-cache.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){return/^following|a8c|likes|conversations/.test(e)}Object.defineProperty(t,"__esModule",{value:!0});var a=s("./node_modules/lru/index.js"),n=o(a),l=new n.default(10),i={};t.default={get:function(e){return r(e)?i[e]:l.get(e)},set:function(e,t){r(e)?i[e]=t:l.set(e,t)},clear:function(){i={},l=new n.default(10)}},e.exports=t.default},"./client/lib/feed-stream-store/feed-stream.js":function(e,t,s){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=s("./node_modules/babel-runtime/core-js/set.js"),n=r(a),l=s("./node_modules/babel-runtime/core-js/object/assign.js"),i=r(l),d=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),c=r(d),u=s("./node_modules/babel-runtime/helpers/createClass.js"),p=r(u),f=s("./node_modules/lodash/lodash.js"),m=s("./node_modules/moment/moment.js"),h=r(m),_=s("./node_modules/debug/browser.js"),g=r(_),b=s("./client/lib/mixins/emitter/index.js"),v=r(b),y=s("./client/lib/feed-post-store/index.js"),j=r(y),x=s("./client/lib/feed-stream-store/actions.js"),k=o(x),P=s("./client/lib/feed-stream-store/constants.js"),S=s("./client/lib/data-poller/index.js"),w=r(S),I=s("./client/reader/controller-helper.js"),C=s("./client/reader/stats.js"),E=o(C),R=s("./client/lib/feed-stream-store/post-key.js"),M=(0,g.default)("calypso:feed-store:post-list-store"),N=function(){function e(t){if((0,c.default)(this,e),!t)throw new Error("must supply a feed stream spec");if(!t.id)throw new Error("missing id");if(!t.fetcher)throw new Error("missing fetcher");if(!t.keyMaker)throw new Error("must supply keyMaker");this.id=t.id,(0,i.default)(this,{id:t.id,postKeys:[],pendingPostKeys:[],postById:new n.default,errors:[],fetcher:t.fetcher,page:1,perPage:7,selectedIndex:-1,xPostedByURL:{},maxUpdates:t.maxUpdates||40,gapFillCount:21,orderBy:"date",_isLastPage:!1,_isFetchingNextPage:!1,keyMaker:t.keyMaker,onNextPageFetch:t.onNextPageFetch||f.noop,onGapFetch:t.onGapFetch||f.noop,onUpdateFetch:t.onUpdateFetch||f.noop,dateProperty:t.dateProperty||"date",poller:w.default.add(this,"pollForUpdates",{interval:6e4,leading:!1,pauseWhenHidden:!1}),startDate:t.startDate})}return(0,p.default)(e,[{key:"destroy",value:function(){w.default.remove(this.poller)}},{key:"handlePayload",value:function(e){var t=e&&e.action;if(t&&t.id===this.id)switch(t.type){case P.action.RECEIVE_PAGE:this.receivePage(t.id,t.error,t.data);break;case P.action.RECEIVE_UPDATES:this.receiveUpdates(t.id,t.error,t.data);break;case P.action.SHOW_UPDATES:this.acceptUpdates();break;case P.action.RECEIVE_GAP:this.receiveFeedGap(t.gap,t.error,t.data);break;case P.action.FETCH_NEXT_PAGE:this.setIsFetchingNextPage(!0);break;case P.action.SELECT_ITEM:this.selectItem(t.postKey,t.id);break;case P.action.SELECT_NEXT_ITEM:this.selectNextItem(t.postKey);break;case P.action.SELECT_PREV_ITEM:this.selectPrevItem(t.postKey);break;case P.action.SELECT_FIRST_ITEM:this.selectFirstItem()}}},{key:"get",value:function(){return this.postKeys}},{key:"getID",value:function(){return this.id}},{key:"getAll",value:function(){return(0,f.map)(this.postKeys,function(e){return e.isGap?e:j.default.get(e)})}},{key:"getPage",value:function(){return this.page}},{key:"getPerPage",value:function(){return this.perPage}},{key:"getUpdateCount",value:function(){return this.pendingPostKeys.length}},{key:"getSelectedPostKey",value:function(){return this.selectedIndex>=0&&this.selectedIndex<this.postKeys.length?this.postKeys[this.selectedIndex]:null}},{key:"isLastPage",value:function(){return this._isLastPage}},{key:"isFetchingNextPage",value:function(){return this._isFetchingNextPage}},{key:"isValidPostOrGap",value:function(e){if(e.isGap===!0)return!0;var t=j.default.get(e);return t&&"error"!==t._state&&"pending"!==t._state&&"minimal"!==t._state}},{key:"selectNextItem",value:function(){var e=this;if(this.selectedIndex!==-1){var t=(0,f.findIndex)(this.postKeys,this.isValidPostOrGap,this.selectedIndex+1);t!==-1&&(this.selectedIndex=t,this.emitChange());var s=10;if(t+s>this.postKeys.length||t===-1){var o=function(){return k.fetchNextPage(e.getID())};(0,f.defer)(o),this.onKeyboardFetchPerformed()}}}},{key:"onKeyboardFetchPerformed",value:function(){E.recordTrack("calypso_reader_fullpost_keyboard_fetch")}},{key:"selectPrevItem",value:function(){if(!(this.selectedIndex<1)){var e=(0,f.findLastIndex)(this.postKeys,this.isValidPostOrGap,this.selectedIndex-1);e!==-1&&(this.selectedIndex=e,this.emitChange())}}},{key:"selectFirstItem",value:function(){0!==this.selectedIndex&&(this.selectedIndex=0,this.emitChange())}},{key:"selectItem",value:function(e,t){var s=(0,f.findIndex)(this.postKeys,e);this.isValidPostOrGap(this.postKeys[s])&&s!==this.selectedIndex&&(this.selectedIndex=s,(0,I.setLastStoreId)(t),this.emitChange())}},{key:"getLastItemWithDate",value:function(){if(this.oldestPostDate)return this.oldestPostDate;var e=this.postKeys.length-1;if(e!==-1){var t=void 0;do{var s=this.postKeys[e];s.isGap||(t=s[this.dateProperty]),--e}while(!t&&e!==-1);return t}}},{key:"getFirstItemWithDate",value:function(){if(0!==this.postKeys.length){var e=0,t=void 0;do{var s=this.postKeys[e];s.isGap||(t=s[this.dateProperty]),++e}while(!t&&e<this.postKeys.length);return t}}},{key:"hasRecentError",value:function(e){var t=Date.now()-6e4;return this.errors.some(function(s){return s.timestamp&&s.timestamp>t&&(!e||e===s.error)})}},{key:"setIsFetchingNextPage",value:function(e){this._isFetchingNextPage=e,this.emitChange()}},{key:"pollForUpdates",value:function(){var e=this;if(this.isFetchingUpdates)return void M("already fetching, skip");if(!this.postKeys.length)return void M("skipping poll because we have no posts");var t=this.getFirstItemWithDate();if(t){this.isFetchingUpdates=!0;var s={orderBy:this.orderBy,number:this.maxUpdates,before:(0,h.default)().toISOString(),after:(0,h.default)(t).toISOString()};this.onUpdateFetch(s),M("polling for updates"),this.fetcher(s,function(t,s){M("poll response received",t,s),e.isFetchingUpdates=!1,k.receiveUpdates(e.id,t,s)})}}},{key:"getSitesCrossPostedTo",value:function(e){return this.xPostedByURL[e]}},{key:"getPostFromMetadata",value:function(e){return e&&(0,f.get)(e,"meta.data.discover_original_post")?e.meta.data.discover_original_post:e&&(0,f.get)(e,"meta.data.post")?e.meta.data.post:e.feed_ID||e.site_ID?e:null}},{key:"addXPost",value:function(e,t){if(this.xPostedByURL[e]){var s=this.xPostedByURL[e];s=s.filter(function(e){return e.siteName!==t.siteName&&e.siteURL!==t.siteURL}),s.push(t),this.xPostedByURL[e]=s}else this.xPostedByURL[e]=[t]}},{key:"filterFollowedXPosts",value:function(e){return e}},{key:"filterNewPosts",value:function(e){var t=this,s=this.postById;return e=(0,f.filter)(e,function(e){return!s.has((0,R.keyToString)(t.keyMaker(e)))}),e=this.filterFollowedXPosts(e),(0,f.map)(e,this.keyMaker)}},{key:"receivePage",value:function(e,t,s){if(e===this.id){if(M("receiving page in %s",this.id),this._isFetchingNextPage=!1,this.oldestPostDate=(0,f.get)(s,["date_range","after"]),this.lastPageHandle=(0,f.get)(s,["meta","next_page"],null),t)return M("Error fetching posts from API:",t),t.timestamp=Date.now(),this.errors.push(t),void this.emitChange();var o=s&&s.posts;if(!o)return void this.emitChange();if(!o.length)return this._isLastPage=!0,void this.emitChange();var r=this.filterNewPosts(o);if(r.length){var a=this.postById;(0,f.forEach)(r,function(e){a.add((0,R.keyToString)(e))}),this.postKeys=this.postKeys.concat(r)}this.page++,this.emitChange()}}},{key:"receiveUpdates",value:function(e,t,s){if(e===this.id&&!t&&s&&s.posts){var o=this.filterNewPosts(s.posts);o.length>0&&(this.pendingPostKeys=o,this.pendingDateAfter=(0,h.default)(this.keyMaker(s.posts[s.posts.length-1])[this.dateProperty]),this.emitChange())}}},{key:"acceptUpdates",value:function(){if(0!==this.pendingPostKeys.length){var e=this.postById;(0,f.forEach)(this.pendingPostKeys,function(t){e.add((0,R.keyToString)(t))});var t=(0,h.default)(this.postKeys[0][this.dateProperty]),s=this.postKeys[0];!(0,f.some)(this.pendingPostKeys,function(e){return(0,R.keysAreEqual)(e,s)})&&this.pendingDateAfter>t&&this.pendingPostKeys.push({isGap:!0,from:t,to:this.pendingDateAfter}),this.postKeys=(0,f.uniqBy)(this.pendingPostKeys.concat(this.postKeys),function(e){return(0,R.keyToString)(e)}),this.selectedIndex>-1&&(this.selectedIndex=-1),this.pendingPostKeys=[],this.pendingDateAfter=null,this.emitChange()}}},{key:"receiveFeedGap",value:function(e,t,s){if(t)return this.errors.push(t),void this.emitChange();var o=s&&s.posts;if(o){var r=this.postKeys.indexOf(e);if(r===-1)return void M("gap %o not found",e);var a=this.postKeys.slice(0,r),n=this.postKeys.slice(r+1),l=this.filterNewPosts(o),i=(0,h.default)(n[0][this.dateProperty]);o.length===this.gapFillCount&&(0,h.default)(o[o.length-1][this.dateProperty])>i&&l.push({isGap:!0,from:i,to:(0,h.default)(o[o.length-1][this.dateProperty])}),this.postKeys=a.concat(l,n),this.emitChange()}}}]),e}();t.default=N,(0,v.default)(N.prototype),e.exports=t.default},"./client/lib/feed-stream-store/index.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){return{feedId:e.feed_ID,postId:e.ID,date:new Date(e.date)}}function a(e){return{blogId:e.site_ID,postId:e.ID,date:new Date(e.date)}}function n(e){return e.feed_ID&&e.feed_item_ID?{feedId:e.feed_ID,postId:e.feed_item_ID,date:new Date(e.date)}:a(e)}function l(e){return function(t){var s=a(t);return(0,R.default)({},s,(0,C.default)({},e,t[e]))}}function i(e){delete e.meta,delete e.orderBy,delete e.before,delete e.after,e.page_handle=this.lastPageHandle}function d(e){var t=this,s=(0,M.map)(e,this.keyMaker);return(0,M.filter)(s,function(e){if(!t.postById.has((0,V.keyToString)(e)))return!0;var s=(0,M.find)(t.postKeys,function(t){return(0,V.keysAreEqual)(t,e)});return!s||!(0,M.isEqual)(s.comments,e.comments)})}function c(e){e.meta="post,discover_original_post"}function u(e){e.fields="ID,site_ID,date"}function p(e){u(e),e.fields+=",date_liked"}function f(e){u(e),e.fields+=",tagged_on"}function m(e){u(e),e.fields+=",last_comment_date_gmt,comments"}function h(e,t){return function(s,o){var r="calypso_traintracks_render";o&&o.algorithm&&(e.algorithm=o.algorithm),(0,M.forEach)(o&&o.posts,function(t){t.railcar&&(e.isQuerySuggestion&&(t.railcar.rec_result="suggestion"),q.default.tracks.recordEvent(r,t.railcar))}),t(s,o)}}function _(e){var t=e.split(":")[1],s=function(e,s){e.ID=t,z.readFeedPosts(e,s)};return new H.default({id:e,fetcher:s,keyMaker:r,onNextPageFetch:c})}function g(e){var t=e.split(":")[1],s=function(e,s){e.tag=t,z.readTagPosts(e,s)};return L.default.isEnabled("reader/tags-with-elasticsearch")?new O.default({id:e,fetcher:s,keyMaker:a,perPage:5}):new H.default({id:e,fetcher:s,keyMaker:l("tagged_on"),onGapFetch:f,onUpdateFetch:f,dateProperty:"tagged_on"})}function b(e){return"relevance"!==e&&"date"!==e?"relevance":e}function v(e){function t(e,t){e.q=r,e.meta="site",e.sort=o,z.readSearch(e,h(n,t))}var s=e.split(":"),o=b(s[1]),r=s.slice(2).join(":"),n=void 0;return n="date"===o?new H.default({id:e,fetcher:t,keyMaker:a,perPage:5,onGapFetch:u,onUpdateFetch:u,maxUpdates:20}):new O.default({id:e,fetcher:t,keyMaker:a,perPage:5}),n.sortOrder=o,n}function y(e){var t=e.split(":")[1],s=t.split("-"),o=(0,w.default)(s),r=o[0],a=o.slice(1),l=function(e,t){e.owner=r,e.slug=a.join("-"),z.readListPosts(e,t)};return new H.default({id:e,fetcher:l,keyMaker:n,onGapFetch:u,onUpdateFetch:u})}function j(e){var t=e.split(":")[1],s=function(e,s){e.site=t,z.readSitePosts(e,s)};return new H.default({id:e,fetcher:s,keyMaker:a,onGapFetch:u,onUpdateFetch:u})}function x(e){var t=e.split(":")[1],s=function(e,s){z.readSiteFeatured(t,e,s)};return new H.default({id:e,fetcher:s,keyMaker:a,onGapFetch:u,onUpdateFetch:u})}function k(e){function t(t,o){switch(e){case"cold_posts":t.algorithm="read:recommendations:posts/es/2";break;case"cold_posts_1w":t.algorithm="read:recommendations:posts/es/3";break;case"cold_posts_2w":t.algorithm="read:recommendations:posts/es/4";
break;case"cold_posts_4w":t.algorithm="read:recommendations:posts/es/5";break;case"cold_posts_topics":t.algorithm="read:recommendations:posts/es/6";break;case"custom_recs_posts_with_images":t.alg_prefix="read:recommendations:posts",t.seed=(0,M.random)(0,1e4);break;default:t.algorithm="read:recommendations:posts/es/1"}z.readRecommendedPosts(t,h(s,o))}var s=new O.default({id:e,fetcher:t,keyMaker:a,perPage:6}),o=s.onNextPageFetch;return s.onNextPageFetch=function(e){o.call(this,e),e.algorithm=s.algorithm},s}function P(e){var t=B.default.get(e);if(t)return t;if("following"===e)t=new H.default({id:e,fetcher:z.readFollowing.bind(z),keyMaker:r,onNextPageFetch:c});else if("conversations"===e)t=new H.default({id:e,fetcher:z.readConversations.bind(z),keyMaker:X,onNextPageFetch:i,onUpdateFetch:m,onGapFetch:m,dateProperty:"last_comment_date_gmt"}),t.filterNewPosts=d;else if("conversations-a8c"===e)t=new H.default({id:e,fetcher:z.readA8cConversations.bind(z),keyMaker:X,onNextPageFetch:i,onUpdateFetch:m,onGapFetch:m,dateProperty:"last_comment_date_gmt"}),t.filterNewPosts=d;else if("a8c"===e)t=new H.default({id:e,fetcher:z.readA8C.bind(z),keyMaker:r,onNextPageFetch:c});else if("likes"===e)t=new H.default({id:e,fetcher:z.readLiked.bind(z),keyMaker:l("date_liked"),onGapFetch:p,onUpdateFetch:p,dateProperty:"date_liked"});else if("recommendations_posts"===e)t=k(e);else if((0,M.startsWith)(e,"cold_posts"))t=k(e);else if((0,M.startsWith)(e,"custom_recs"))t=k(e);else if((0,M.startsWith)(e,"feed:"))t=_(e);else if((0,M.startsWith)(e,"tag:"))t=g(e);else if((0,M.startsWith)(e,"list:"))t=y(e);else if((0,M.startsWith)(e,"site:"))t=j(e);else if((0,M.startsWith)(e,"featured:"))t=x(e);else{if(!(0,M.startsWith)(e,"search:"))throw new Error("Unknown feed store ID");t=v(e)}return t.dispatchToken=F.default.register(t.handlePayload.bind(t)),B.default.set(e,t),t}Object.defineProperty(t,"__esModule",{value:!0});var S=s("./node_modules/babel-runtime/helpers/toArray.js"),w=o(S),I=s("./node_modules/babel-runtime/helpers/defineProperty.js"),C=o(I),E=s("./node_modules/babel-runtime/helpers/extends.js"),R=o(E);t.default=P;var M=s("./node_modules/lodash/lodash.js"),N=s("./client/config/index.js"),L=o(N),T=s("./client/dispatcher/index.js"),F=o(T),D=s("./client/lib/feed-stream-store/feed-stream.js"),H=o(D),A=s("./client/lib/feed-stream-store/paged-stream.js"),O=o(A),U=s("./client/lib/feed-stream-store/feed-stream-cache.js"),B=o(U),K=s("./client/lib/analytics/index.js"),q=o(K),W=s("./client/lib/wp/browser.js"),G=o(W),V=s("./client/lib/feed-stream-store/post-key.js"),z=G.default.undocumented(),X=function(){var e=l("last_comment_date_gmt");return function(t){var s=e(t);return s.comments=(0,M.map)(t.comments,"ID").reverse(),s}}();e.exports=t.default},"./client/lib/feed-stream-store/paged-stream.js":function(e,t,s){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=s("./node_modules/babel-runtime/helpers/toConsumableArray.js"),n=r(a),l=s("./node_modules/babel-runtime/core-js/set.js"),i=r(l),d=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),c=r(d),u=s("./node_modules/babel-runtime/helpers/createClass.js"),p=r(u),f=s("./node_modules/lodash/lodash.js"),m=s("./node_modules/debug/browser.js"),h=r(m),_=s("./client/lib/mixins/emitter/index.js"),g=r(_),b=s("./client/lib/feed-post-store/index.js"),v=r(b),y=s("./client/lib/feed-stream-store/constants.js"),j=s("./client/reader/controller-helper.js"),x=s("./client/lib/feed-stream-store/actions.js"),k=o(x),P=(0,h.default)("calypso:feed-store:post-list-store"),S=function(){function e(t){if((0,c.default)(this,e),!t)throw new Error("must supply a paged stream spec");if(!t.id)throw new Error("missing id");if(!t.fetcher)throw new Error("missing fetcher");if(!t.keyMaker)throw new Error("must supply keyMaker");this.id=t.id,(0,f.assign)(this,{id:t.id,postKeys:[],pendingPostKeys:[],postById:new i.default,errors:[],fetcher:t.fetcher,page:1,perPage:t.perPage||10,query:t.query,selectedIndex:-1,orderBy:"date",_isLastPage:!1,_isFetchingNextPage:!1,keyMaker:t.keyMaker})}return(0,p.default)(e,[{key:"handlePayload",value:function(e){var t=e&&e.action;if(t&&t.id===this.id)switch(t.type){case y.action.RECEIVE_PAGE:this.receivePage(t.id,t.error,t.data);break;case y.action.FETCH_NEXT_PAGE:this.setIsFetchingNextPage(!0);break;case y.action.SELECT_ITEM:this.selectItem(t.selectedIndex);break;case y.action.SELECT_NEXT_ITEM:this.selectNextItem(t.selectedIndex);break;case y.action.SELECT_PREV_ITEM:this.selectPrevItem(t.selectedIndex);break;case y.action.SELECT_FIRST_ITEM:this.selectFirstItem();break;case y.action.DISMISS_FEED_STREAM_POST:this.dismissPost(t.postKey)}}},{key:"get",value:function(){return this.postKeys}},{key:"getID",value:function(){return this.id}},{key:"getAll",value:function(){return(0,f.map)(this.postKeys,function(e){return v.default.get(e)})}},{key:"getPage",value:function(){return this.page}},{key:"getPerPage",value:function(){return this.perPage}},{key:"getUpdateCount",value:function(){return 0}},{key:"getSelectedPostKey",value:function(){return this.selectedIndex>=0&&this.selectedIndex<this.postKeys.length?this.postKeys[this.selectedIndex]:null}},{key:"getSelectedIndex",value:function(){return this.selectedIndex}},{key:"isLastPage",value:function(){return this._isLastPage}},{key:"isFetchingNextPage",value:function(){return this._isFetchingNextPage}},{key:"isValidPostOrGap",value:function(e){var t=v.default.get(e);return t&&"error"!==t._state&&"pending"!==t._state&&"minimal"!==t._state}},{key:"selectNextItem",value:function(){var e=this;if(this.selectedIndex!==-1){var t=(0,f.findIndex)(this.postKeys,this.isValidPostOrGap,this.selectedIndex+1);t!==-1&&(this.selectedIndex=t,this.emitChange());var s=10;if(t+s>this.postKeys.length||t===-1){var o=function(){return k.fetchNextPage(e.getID())};(0,f.defer)(o)}}}},{key:"selectPrevItem",value:function(){if(!(this.selectedIndex<1)){var e=(0,f.findLastIndex)(this.postKeys,this.isValidPostOrGap,this.selectedIndex-1);e!==-1&&(this.selectedIndex=e,this.emitChange())}}},{key:"selectFirstItem",value:function(){0!==this.selectedIndex&&(this.selectedIndex=0,this.emitChange())}},{key:"selectItem",value:function(e,t){var s=(0,f.findIndex)(this.postKeys,e);this.isValidPostOrGap(this.postKeys[s])&&s!==this.selectedIndex&&(this.selectedIndex=s,(0,j.setLastStoreId)(t),this.emitChange())}},{key:"onNextPageFetch",value:function(e){e.offset=(this.page-1)*this.perPage,e.before=this.startDate||void 0,e.after=void 0,e.number=this.perPage}},{key:"getLastItemWithDate",value:function(){return null}},{key:"getFirstItemWithDate",value:function(){return null}},{key:"hasRecentError",value:function(e){var t=Date.now()-6e4;return this.errors.some(function(s){return s.timestamp&&s.timestamp>t&&(!e||e===s.error)})}},{key:"setIsFetchingNextPage",value:function(e){this._isFetchingNextPage=e,this.emitChange()}},{key:"filterNewPosts",value:function(e){var t=this.postById;return e=(0,f.filter)(e,function(e){return!t.has(e.ID)}),(0,f.map)(e,this.keyMaker)}},{key:"getSitesCrossPostedTo",value:function(){return null}},{key:"receivePage",value:function(e,t,s){if(e===this.id){if(P("receiving page in %s",this.id),this._isFetchingNextPage=!1,t)return P("Error fetching posts from API:",t),t.timestamp=Date.now(),this.errors.push(t),void this.emitChange();var o=s&&s.posts;if(o){if(!o.length)return this._isLastPage=!0,void this.emitChange();var r=this.filterNewPosts(o);if(r.length){var a=this.postById;(0,f.forEach)(r,function(e){a.add(e.postId)}),this.postKeys=this.postKeys.concat(r),this.page++,this.emitChange()}}}}},{key:"dismissPost",value:function(e){var t=(0,f.findIndex)(this.postKeys,e);if(t!==-1){var s=[].concat((0,n.default)(this.postKeys)),o=(0,f.last)(s),r=s[t];s[t]=o,s.pop(),this.postById.delete(r.postId),this.postKeys=s,this.emitChange()}}}]),e}();t.default=S,(0,g.default)(S.prototype),e.exports=t.default},"./client/lib/infinite-list/actions.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/lodash/lodash.js"),a=s("./client/dispatcher/index.js"),n=o(a),l=s("./client/lib/infinite-list/scroll-store.js"),i=o(l),d=s("./client/lib/infinite-list/positions-store.js"),c=o(d),u=null,p=null,f=1e3,m={leading:!1};t.default={storePositions:(0,r.throttle)(function(e,t){u||setTimeout(function(){var e=c.default.get(u.url);(0,r.isEqual)(u.positions,e)||n.default.handleViewAction({type:"INFINITE_LIST_POSITION_CHANGED",url:u.url,positions:u.positions}),u=null},0),u={url:e,positions:t}},f,m),storeScroll:(0,r.throttle)(function(e,t){p||setTimeout(function(){var e=i.default.get(p.url);p.scrollPosition!==e&&n.default.handleViewAction({type:"SCROLL_CHANGED",url:p.url,scrollPosition:p.scrollPosition}),p=null},0),p={url:e,scrollPosition:t}},f,m)},e.exports=t.default},"./client/lib/infinite-list/positions-store.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var s=m.get(e);p("comparing positions:",e,s,t),(0,a.isEqual)(s,t)||(p("storing values:",e,t),f[e]=t,m.emit("change"))}Object.defineProperty(t,"__esModule",{value:!0});var a=s("./node_modules/lodash/lodash.js"),n=s("./node_modules/debug/browser.js"),l=o(n),i=s("./client/dispatcher/index.js"),d=o(i),c=s("./client/lib/mixins/emitter/index.js"),u=o(c),p=(0,l.default)("calypso:infinite-list:positions-store"),f={},m={get:function(e){return p("positions-store:get(): ",e,f),f[e]}};(0,u.default)(m),m.dispatchToken=d.default.register(function(e){var t=e.action;switch(t.type){case"INFINITE_LIST_POSITION_CHANGED":r(t.url,t.positions)}}),t.default=m,e.exports=t.default},"./client/lib/infinite-list/scroll-store.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var s=i.get(e);s!==t&&(l[e]=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=s("./client/dispatcher/index.js"),n=o(a),l={},i={get:function(e){return l[e]}};i.dispatchToken=n.default.register(function(e){var t=e.action;switch(t.type){case"SCROLL_CHANGED":r(t.url,t.scrollPosition)}}),t.default=i,e.exports=t.default},"./client/lib/inflight/index.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t._clear=t.trackPromise=t.requestTracker=t.completeRequest=t.markRequestInflight=t.isRequestInflight=void 0;var r=s("./node_modules/babel-runtime/core-js/set.js"),a=o(r),n=new a.default;t.isRequestInflight=function(e){return n.has(e)},t.markRequestInflight=function(e){return n.add(e)},t.completeRequest=function(e){return n.delete(e)},t.requestTracker=function(e,t){return n.add(e),function(s,o){n.delete(e),t(s,o)}},t.trackPromise=function(e,t){return n.add(e),t.then(function(){n.delete(e)},function(){n.delete(e)}),t},t._clear=function(){return n.clear()}},"./client/lib/reader-post-flux-adapter/index.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/helpers/extends.js"),a=o(r),n=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/createClass.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),f=o(p),m=s("./node_modules/babel-runtime/helpers/inherits.js"),h=o(m),_=s("./node_modules/react/react.js"),g=o(_),b=s("./node_modules/prop-types/index.js"),v=o(b),y=s("./node_modules/lodash/lodash.js"),j=s("./node_modules/react-redux/es/index.js"),x=s("./client/lib/feed-post-store/index.js"),k=o(x),P=s("./client/lib/feed-post-store/actions.js"),S=s("./client/state/reader/sites/selectors.js"),w=s("./client/state/reader/feeds/selectors.js"),I=function(e){var t=function(t){function s(){var e,t,o,r;(0,d.default)(this,s);for(var a=arguments.length,n=Array(a),i=0;i<a;i++)n[i]=arguments[i];return t=o=(0,f.default)(this,(e=s.__proto__||(0,l.default)(s)).call.apply(e,[this].concat(n))),o.getStateFromStores=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.props,t=e.postKey,s=(0,y.map)(t.postIds,function(e){var s={};t.feedId?s.feedId=t.feedId:s.blogId=t.blogId,s.postId=e;var o=k.default.get(s);return o&&"minimal"!==o._state||(0,P.fetchPost)(s),o});return{posts:s}},o.state=o.getStateFromStores(o.props),o.updateState=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.getStateFromStores();o.setState(e)},r=t,(0,f.default)(o,r)}return(0,h.default)(s,t),(0,u.default)(s,[{key:"componentWillMount",value:function(){k.default.on("change",this.updateState)}},{key:"componentWillReceiveProps",value:function(e){this.updateState(this.getStateFromStores(e))}},{key:"componentWillUnmount",value:function(){k.default.off("change",this.updateState)}},{key:"render",value:function(){var t=this.state,s=t.post,o=t.posts;return s||o?g.default.createElement(e,(0,a.default)({},this.props,{post:s,posts:o})):null}}]),s}(g.default.PureComponent);return t.propTypes={postKey:v.default.object,selectedPost:v.default.string,feed:v.default.object,site:v.default.object},(0,j.connect)(function(e,t){var s=t.postKey,o=s.feedId,r=s.blogId,a=void 0,n=void 0;return o?(a=(0,w.getFeed)(e,o),n=a&&a.blog_ID?(0,S.getSite)(e,a.blog_ID):void 0):(n=(0,S.getSite)(e,r),a=n&&n.feed_ID?(0,w.getFeed)(e,n.feed_ID):void 0),{feed:a,site:n}})(t)};t.default=I,e.exports=t.default},"./client/lib/track-scroll-page/index.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,s,o){a.default.ga.recordEvent(s,"Loaded Next Page","page",o),a.default.pageView.record(e,t),a.default.mc.bumpStat("newdash_pageviews","scroll")};var r=s("./client/lib/analytics/index.js"),a=o(r);e.exports=t.default},"./client/my-sites/comments/comment-navigation/comment-navigation-tab.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.CommentNavigationTab=void 0;var r=s("./node_modules/react/react.js"),a=o(r),n=s("./node_modules/classnames/index.js"),l=o(n),i=t.CommentNavigationTab=function(e){var t=e.children,s=e.className,o=e.onClick;return a.default.createElement("div",{className:(0,l.default)("comment-navigation__tab",s),onClick:o},t)};t.default=i},"./client/reader/controller-helper.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){k=e}function a(){return k?(0,x.default)(k):null}function n(e,t){if(1===e.getPage()){if(t&&t.query&&t.query.at){var s=(0,f.default)(t.query.at);s.isValid()&&(e.startDate=s.format())}(0,y.fetchNextPage)(e.id)}return e}function l(e,t,s){g.default.pageView.record(e,t),g.default.mc.bumpStat("reader_views","full_post"===s?s:s+"_load")}function i(e,t,s,o,r){g.default.ga.recordEvent(s,"Loaded Next Page","page",r),(0,b.recordTrack)("calypso_reader_infinite_scroll_performed",{path:e,page:r,section:o}),g.default.pageView.record(e,t),g.default.mc.bumpStat({newdash_pageviews:"scroll",reader_views:o+"_scroll"})}function d(e){g.default.mc.bumpStat("reader_views",e+"_load_new"),g.default.ga.recordEvent("Reader","Clicked Load New Posts",e),(0,b.recordTrack)("calypso_reader_load_new_posts",{section:e})}function c(e,t){e.store.dispatch((0,v.setDocumentHeadTitle)(h.default.translate("%s  Reader",{args:t})))}function u(e){return!!e.lastRoute}Object.defineProperty(t,"__esModule",{value:!0}),t.setLastStoreId=r,t.getLastStore=a,t.ensureStoreLoading=n,t.trackPageLoad=l,t.trackScrollPage=i,t.trackUpdatesLoaded=d,t.setPageTitle=c,t.userHasHistory=u;var p=s("./node_modules/moment/moment.js"),f=o(p),m=s("./node_modules/i18n-calypso/index.js"),h=o(m),_=s("./client/lib/analytics/index.js"),g=o(_),b=s("./client/reader/stats.js"),v=s("./client/state/document-head/actions.js"),y=s("./client/lib/feed-stream-store/actions.js"),j=s("./client/lib/feed-stream-store/index.js"),x=o(j),k=void 0},"./client/reader/controller.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){return!!e.lastRoute}function a(e){(0,E.renderWithReduxStore)(d.default.createElement(k.default),document.getElementById("primary"),e.store)}Object.defineProperty(t,"__esModule",{value:!0}),t.readA8C=t.blogListing=t.feedListing=t.feedDiscovery=t.following=t.unmountSidebar=t.sidebar=t.preloadReaderBundle=t.incompleteUrlRedirects=t.updateLastRoute=t.legacyRedirects=t.prettyRedirects=t.initAbTests=void 0;var n=s("./node_modules/react-dom/index.js"),l=o(n),i=s("./node_modules/react/react.js"),d=o(i),c=s("./node_modules/page/index.js"),u=o(c),p=s("./node_modules/i18n-calypso/index.js"),f=o(p),m=s("./client/lib/abtest/index.js"),h=s("./client/lib/route/index.js"),_=o(h),g=s("./client/lib/feed-lookup/index.js"),b=o(g),v=s("./client/lib/feed-stream-store/index.js"),y=o(v),j=s("./client/reader/controller-helper.js"),x=s("./client/reader/feed-error/index.jsx"),k=o(x),P=s("./client/reader/following/main.jsx"),S=o(P),w=s("./client/reader/route/index.js"),I=s("./client/reader/stats.js"),C=s("./client/sections-preload.js"),E=s("./client/lib/react-helpers/index.js"),R=s("./client/components/async-load/index.jsx"),M=o(R),N="Reader",L=[],T=null,F=function(e){s.e("async-load-reader-sidebar").then(function(t){e(s("./client/reader/sidebar/index.jsx").__esModule?s("./client/reader/sidebar/index.jsx").default:s("./client/reader/sidebar/index.jsx"))}.bind(null,s)).catch(s.oe)},D=function(e){s.e("async-load-reader-feed-stream").then(function(t){e(s("./client/reader/feed-stream/index.jsx").__esModule?s("./client/reader/feed-stream/index.jsx").default:s("./client/reader/feed-stream/index.jsx"))}.bind(null,s)).catch(s.oe)},H=function(e){s.e("async-load-reader-site-stream").then(function(t){e(s("./client/reader/site-stream/index.jsx").__esModule?s("./client/reader/site-stream/index.jsx").default:s("./client/reader/site-stream/index.jsx"))}.bind(null,s)).catch(s.oe)},A=function(e){s.e("async-load-reader-team-main").then(function(t){e(s("./client/reader/team/main.jsx").__esModule?s("./client/reader/team/main.jsx").default:s("./client/reader/team/main.jsx"))}.bind(null,s)).catch(s.oe)},O={initAbTests:function(e,t){L.forEach(function(e){return(0,m.abtest)(e)}),t()},prettyRedirects:function(e,t){var s=void 0;return e.params.blog_id?s=(0,w.getPrettySiteUrl)(e.params.blog_id):e.params.feed_id&&(s=(0,w.getPrettyFeedUrl)(e.params.feed_id)),s?u.default.redirect(s):void t()},legacyRedirects:function(e,t){var s={feedStream:/^\/read\/blog\/feed\/([0-9]+)$/i,feedFullPost:/^\/read\/post\/feed\/([0-9]+)\/([0-9]+)$/i,blogStream:/^\/read\/blog\/id\/([0-9]+)$/i,blogFullPost:/^\/read\/post\/id\/([0-9]+)\/([0-9]+)$/i};e.path.match(s.feedStream)?u.default.redirect("/read/feeds/"+e.params.feed_id):e.path.match(s.feedFullPost)?u.default.redirect("/read/feeds/"+e.params.feed_id+"/posts/"+e.params.post_id):e.path.match(s.blogStream)?u.default.redirect("/read/blogs/"+e.params.blog_id):e.path.match(s.blogFullPost)&&u.default.redirect("/read/blogs/"+e.params.blog_id+"/posts/"+e.params.post_id),t()},updateLastRoute:function(e,t){T&&(e.lastRoute=T),T=e.path,t()},incompleteUrlRedirects:function(e,t){var s=void 0;return e.path.match(/^\/read\/feeds\/([0-9]+)\/posts$/i)?s="/read/feeds/"+e.params.feed_id:e.path.match(/^\/read\/blogs\/([0-9]+)\/posts$/i)&&(s="/read/blogs/"+e.params.blog_id),s?u.default.redirect(s):void t()},preloadReaderBundle:function(e,t){(0,C.preload)("reader"),t()},sidebar:function(e,t){(0,E.renderWithReduxStore)(d.default.createElement(M.default,{require:F,path:e.path}),document.getElementById("secondary"),e.store),t()},unmountSidebar:function(e,t){l.default.unmountComponentAtNode(document.getElementById("secondary")),t()},following:function(e){var t=_.default.sectionify(e.path),s=N+" > Following",o=(0,y.default)("following"),r="following",a=(0,y.default)("custom_recs_posts_with_images");a.perPage=4,(0,j.ensureStoreLoading)(o,e),(0,j.trackPageLoad)(t,s,r),(0,I.recordTrack)("calypso_reader_following_loaded"),(0,j.setPageTitle)(e,f.default.translate("Following")),(0,E.renderWithReduxStore)(d.default.createElement(S.default,{key:"following",listName:f.default.translate("Followed Sites"),postsStore:o,recommendationsStore:a,showPrimaryFollowButtonOnCards:!1,trackScrollPage:j.trackScrollPage.bind(null,t,s,N,r),onUpdatesShown:j.trackUpdatesLoaded.bind(null,r)}),"primary",e.store)},feedDiscovery:function(e,t){e.params.feed_id.match(/^\d+$/)?t():(0,b.default)(e.params.feed_id).then(function(e){u.default.redirect("/read/feeds/"+e)}).catch(function(){a(e)})},feedListing:function(e){var t="/read/feeds/:feed_id",s=N+" > Feed > "+e.params.feed_id,o=(0,y.default)("feed:"+e.params.feed_id),a="blog";(0,j.ensureStoreLoading)(o,e),(0,j.trackPageLoad)(t,s,a),(0,I.recordTrack)("calypso_reader_blog_preview",{feed_id:e.params.feed_id}),(0,E.renderWithReduxStore)(d.default.createElement(M.default,{require:D,key:"feed-"+e.params.feed_id,postsStore:o,feedId:+e.params.feed_id,trackScrollPage:j.trackScrollPage.bind(null,t,s,N,a),onUpdatesShown:j.trackUpdatesLoaded.bind(null,a),showPrimaryFollowButtonOnCards:!1,suppressSiteNameLink:!0,showBack:r(e)}),document.getElementById("primary"),e.store)},blogListing:function(e){var t="/read/blogs/:blog_id",s=N+" > Site > "+e.params.blog_id,o=(0,y.default)("site:"+e.params.blog_id),a="blog";(0,j.ensureStoreLoading)(o,e),(0,j.trackPageLoad)(t,s,a),(0,I.recordTrack)("calypso_reader_blog_preview",{blog_id:e.params.blog_id}),(0,E.renderWithReduxStore)(d.default.createElement(M.default,{require:H,key:"site-"+e.params.blog_id,postsStore:o,siteId:+e.params.blog_id,trackScrollPage:j.trackScrollPage.bind(null,t,s,N,a),onUpdatesShown:j.trackUpdatesLoaded.bind(null,a),showPrimaryFollowButtonOnCards:!1,suppressSiteNameLink:!0,showBack:r(e)}),document.getElementById("primary"),e.store)},readA8C:function(e){var t=_.default.sectionify(e.path),s=N+" > A8C",o=(0,y.default)("a8c"),r="a8c";(0,j.ensureStoreLoading)(o,e),(0,j.trackPageLoad)(t,s,r),(0,j.setPageTitle)(e,"Automattic"),(0,E.renderWithReduxStore)(d.default.createElement(M.default,{require:A,key:"read-a8c",className:"is-a8c",listName:"Automattic",postsStore:o,trackScrollPage:j.trackScrollPage.bind(null,t,s,N,r),showPrimaryFollowButtonOnCards:!1,onUpdatesShown:j.trackUpdatesLoaded.bind(null,r)}),document.getElementById("primary"),e.store)}},U=O.initAbTests,B=O.prettyRedirects,K=O.legacyRedirects,q=O.updateLastRoute,W=O.incompleteUrlRedirects,G=O.preloadReaderBundle,V=O.sidebar,z=O.unmountSidebar,X=O.following,Y=O.feedDiscovery,$=O.feedListing,Q=O.blogListing,J=O.readA8C;t.initAbTests=U,t.prettyRedirects=B,t.legacyRedirects=K,t.updateLastRoute=q,t.incompleteUrlRedirects=W,t.preloadReaderBundle=G,t.sidebar=V,t.unmountSidebar=z,t.following=X,t.feedDiscovery=Y,t.feedListing=$,t.blogListing=Q,t.readA8C=J},"./client/reader/conversations/controller.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=d.default.sectionify(e.path),s="conversations",o="Reader > Conversations";(0,m.trackPageLoad)(t,"Reader > Conversations",s),(0,c.recordTrack)("calypso_reader_conversations_viewed");var r=(0,_.default)("conversations");(0,m.ensureStoreLoading)(r,e);var a=m.trackScrollPage.bind(null,"/read/conversations",o,"Reader",s);(0,u.renderWithReduxStore)(l.default.createElement(f.default,{require:g,key:"conversations",title:"Conversations",store:r,trackScrollPage:a}),document.getElementById("primary"),e.store)}function a(e){var t=d.default.sectionify(e.path),s="conversations-a8c",o="Reader > Conversations > Automattic";(0,m.trackPageLoad)(t,"Reader > Conversations > Automattic",s),(0,c.recordTrack)("calypso_reader_conversations_a8c_viewed");var r=(0,_.default)("conversations-a8c");(0,m.ensureStoreLoading)(r,e);var a=m.trackScrollPage.bind(null,"/read/conversations/a8c",o,"Reader",s);(0,u.renderWithReduxStore)(l.default.createElement(f.default,{require:b,key:"conversations",title:"Conversations @ Automattic",store:r,trackScrollPage:a}),document.getElementById("primary"),e.store)}Object.defineProperty(t,"__esModule",{value:!0}),t.conversations=r,t.conversationsA8c=a;var n=s("./node_modules/react/react.js"),l=o(n),i=s("./client/lib/route/index.js"),d=o(i),c=s("./client/reader/stats.js"),u=s("./client/lib/react-helpers/index.js"),p=s("./client/components/async-load/index.jsx"),f=o(p),m=s("./client/reader/controller-helper.js"),h=s("./client/lib/feed-stream-store/index.js"),_=o(h),g=function(e){s.e("async-load-reader-conversations-stream").then(function(t){e(s("./client/reader/conversations/stream.js").__esModule?s("./client/reader/conversations/stream.js").default:s("./client/reader/conversations/stream.js"))}.bind(null,s)).catch(s.oe)},b=function(e){s.e("async-load-reader-conversations-stream").then(function(t){e(s("./client/reader/conversations/stream.js").__esModule?s("./client/reader/conversations/stream.js").default:s("./client/reader/conversations/stream.js"))}.bind(null,s)).catch(s.oe)}},"./client/reader/conversations/index.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){l.default.isEnabled("reader/conversations")?((0,a.default)("/read/conversations",d.preloadReaderBundle,d.updateLastRoute,d.initAbTests,d.sidebar,i.conversations),(0,a.default)("/read/conversations/a8c",d.preloadReaderBundle,d.updateLastRoute,d.initAbTests,d.sidebar,i.conversationsA8c)):((0,a.default)("/read/conversations","/"),(0,a.default)("/read/conversations/a8c","/"))};var r=s("./node_modules/page/index.js"),a=o(r),n=s("./client/config/index.js"),l=o(n),i=s("./client/reader/conversations/controller.js"),d=s("./client/reader/controller.js");e.exports=t.default},"./client/reader/discover/controller.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.discover=void 0;var r=s("./node_modules/react/react.js"),a=o(r),n=s("./client/config/index.js"),l=o(n),i=s("./client/lib/route/index.js"),d=o(i),c=s("./client/lib/feed-stream-store/index.js"),u=o(c),p=s("./client/reader/stats.js"),f=s("./client/reader/controller-helper.js"),m=s("./client/lib/react-helpers/index.js"),h=s("./client/components/async-load/index.jsx"),_=o(h),g="Reader",b=function(e){s.e("async-load-reader-site-stream").then(function(t){e(s("./client/reader/site-stream/index.jsx").__esModule?s("./client/reader/site-stream/index.jsx").default:s("./client/reader/site-stream/index.jsx"))}.bind(null,s)).catch(s.oe)},v={discover:function(e){var t=(0,l.default)("discover_blog_id"),s=d.default.sectionify(e.path),o=g+" > Site > "+t,r=(0,u.default)("site:"+t),n=(0,u.default)("featured:"+t),i="discover";(0,f.ensureStoreLoading)(r,e),(0,f.ensureStoreLoading)(n,e),(0,f.trackPageLoad)(s,o,i),(0,p.recordTrack)("calypso_reader_discover_viewed"),(0,m.renderWithReduxStore)(a.default.createElement(_.default,{require:b,key:"site-"+t,postsStore:r,siteId:+t,title:"Discover",trackScrollPage:f.trackScrollPage.bind(null,s,o,g,i),onUpdatesShown:f.trackUpdatesLoaded.bind(null,i),suppressSiteNameLink:!0,showPrimaryFollowButtonOnCards:!1,isDiscoverStream:!0,showBack:!1,className:"is-discover-stream is-site-stream",featuredStore:n}),document.getElementById("primary"),e.store)}};t.default=v;var y=v.discover;t.discover=y},"./client/reader/discover/index.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){(0,a.default)("/discover",l.preloadReaderBundle,l.updateLastRoute,l.initAbTests,l.sidebar,n.discover)};var r=s("./node_modules/page/index.js"),a=o(r),n=s("./client/reader/discover/controller.js"),l=s("./client/reader/controller.js");e.exports=t.default},"./client/reader/feed-error/index.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),a=o(r),n=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/createClass.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/inherits.js"),f=o(p),m=s("./node_modules/prop-types/index.js"),h=o(m),_=s("./node_modules/react/react.js"),g=o(_),b=s("./node_modules/i18n-calypso/index.js"),v=o(b),y=s("./client/components/reader-main/index.jsx"),j=o(y),x=s("./client/components/mobile-back-to-sidebar/index.jsx"),k=o(x),P=s("./client/components/empty-content/index.jsx"),S=o(P),w=s("./client/reader/stats.js"),I=function(e){function t(){var e,s,o,r;(0,l.default)(this,t);for(var n=arguments.length,i=Array(n),d=0;d<n;d++)i[d]=arguments[d];return s=o=(0,u.default)(this,(e=t.__proto__||(0,a.default)(t)).call.apply(e,[this].concat(i))),o.recordAction=function(){(0,w.recordAction)("clicked_search_on_404"),(0,w.recordGaEvent)("Clicked Search on 404"),(0,w.recordTrack)("calypso_reader_search_on_feed_error_clicked")},o.recordSecondaryAction=function(){(0,w.recordAction)("clicked_discover_on_404"),(0,w.recordGaEvent)("Clicked Discover on 404"),(0,w.recordTrack)("calypso_reader_discover_on_feed_error_clicked")},r=s,(0,u.default)(o,r)}return(0,f.default)(t,e),(0,d.default)(t,[{key:"render",value:function(){var e=g.default.createElement("a",{className:"empty-content__action button is-primary",onClick:this.recordAction,href:"/read/search"},this.props.translate("Find Sites to Follow")),t=g.default.createElement("a",{className:"empty-content__action button",onClick:this.recordSecondaryAction,href:"/discover"},this.props.translate("Explore Discover"));return g.default.createElement(j.default,null,g.default.createElement(k.default,null,g.default.createElement("h1",null,this.props.sidebarTitle)),g.default.createElement(S.default,{action:e,secondaryAction:t,title:this.props.message,illustration:"/calypso/images/illustrations/illustration-404.svg",illustrationWidth:500}))}}]),t}(g.default.Component);I.defaultProps={message:v.default.translate("Sorry, we can't find that site.")},I.propTypes={sidebarTitle:h.default.string},t.default=(0,b.localize)(I),e.exports=t.default},"./client/reader/following/controller.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.followingManage=t.followingEdit=void 0;var r=s("./node_modules/react/react.js"),a=o(r),n=s("./node_modules/i18n-calypso/index.js"),l=o(n),i=s("./client/lib/route/index.js"),d=o(i),c=s("./client/lib/user-settings/index.js"),u=o(c),p=s("./client/reader/controller-helper.js"),f=s("./client/lib/react-helpers/index.js"),m=s("./client/components/async-load/index.jsx"),h=o(m),_="Reader",g=function(e){s.e("async-load-reader-following-manage").then(function(t){e(s("./client/reader/following-manage/index.jsx").__esModule?s("./client/reader/following-manage/index.jsx").default:s("./client/reader/following-manage/index.jsx"))}.bind(null,s)).catch(s.oe)},b={followingManage:function(e){var t=d.default.sectionify(e.path),s=_+" > Manage Followed Sites",o="following_manage",r=e.query,n=r.q,i=r.s,c=r.sort,m=r.showMoreResults;(0,p.setPageTitle)(e,l.default.translate("Manage Followed Sites")),(0,p.trackPageLoad)(t,s,o),(0,f.renderWithReduxStore)(a.default.createElement(h.default,{require:g,key:"following-manage",initialFollowUrl:e.query.follow,sitesQuery:n,subsQuery:i,showMoreResults:Boolean(m),subsSortOrder:c,context:e,userSettings:u.default}),document.getElementById("primary"),e.store)}};t.default=b;var v=b.followingEdit,y=b.followingManage;t.followingEdit=v,t.followingManage=y},"./client/reader/following/index.js":function(e,t,s){"use strict";
function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){(0,a.default)("/following/*",l.initAbTests),(0,a.default)("/following/manage",l.updateLastRoute,l.sidebar,n.followingManage),a.default.redirect("/following/edit*","/following/manage")};var r=s("./node_modules/page/index.js"),a=o(r),n=s("./client/reader/following/controller.js"),l=s("./client/reader/controller.js");e.exports=t.default},"./client/reader/following/intro.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),a=o(r),n=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/createClass.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/inherits.js"),f=o(p),m=s("./node_modules/react/react.js"),h=o(m),_=s("./node_modules/i18n-calypso/index.js"),g=s("./node_modules/gridicons/build/index.js"),b=o(g),v=s("./node_modules/react-redux/es/index.js"),y=s("./node_modules/redux/lib/index.js"),j=s("./client/components/data/query-preferences/index.jsx"),x=o(j),k=s("./client/state/preferences/actions.js"),P=s("./client/state/preferences/selectors.js"),S=s("./client/reader/stats.js"),w=s("./client/state/ui/guided-tours/contexts.js"),I=function(e){function t(){var e,s,o,r;(0,l.default)(this,t);for(var n=arguments.length,i=Array(n),d=0;d<n;d++)i[d]=arguments[d];return s=o=(0,u.default)(this,(e=t.__proto__||(0,a.default)(t)).call.apply(e,[this].concat(i))),o.recordRenderTrack=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.props;e.isNewReader===!0&&(0,S.recordTrack)("calypso_reader_following_intro_render")},r=s,(0,u.default)(o,r)}return(0,f.default)(t,e),(0,d.default)(t,[{key:"componentDidMount",value:function(){this.recordRenderTrack()}},{key:"componentWillReceiveProps",value:function(e){this.props.isNewReader!==e.isNewReader&&this.recordRenderTrack(e)}},{key:"render",value:function(){var e=this.props,t=e.isNewReader,s=e.translate,o=e.dismiss,r=e.isNewUser;if(!t||!r)return null;var a=h.default.createElement("a",{onClick:this.props.handleManageLinkClick,href:"/following/manage"});return h.default.createElement("header",{className:"following__intro"},h.default.createElement(x.default,null),h.default.createElement("div",{className:"following__intro-header"},h.default.createElement("div",{className:"following__intro-copy"},h.default.createElement("span",null,s("{{strong}}Welcome!{{/strong}} Reader is a custom magazine. {{link}}Follow your favorite sites{{/link}} and their latest posts will appear here. {{span}}Read, like, and comment in a distraction-free environment.{{/span}}",{components:{link:a,strong:h.default.createElement("strong",null),span:h.default.createElement("span",{className:"following__intro-copy-hidden"})}}))),h.default.createElement("div",{className:"following__intro-character"}),h.default.createElement("div",{className:"following__intro-close",onClick:o,title:s("Close"),role:"button","aria-label":s("Close")},h.default.createElement(b.default,{icon:"cross-circle",className:"following__intro-close-icon",title:s("Close")}),h.default.createElement("span",{className:"following__intro-close-icon-bg"}))))}}]),t}(h.default.Component);t.default=(0,v.connect)(function(e){return{isNewReader:(0,P.getPreference)(e,"is_new_reader"),isNewUser:(0,w.isUserNewerThan)(2*w.WEEK_IN_MILLISECONDS)(e)}},function(e){return(0,y.bindActionCreators)({dismiss:function(){return(0,S.recordTrack)("calypso_reader_following_intro_dismiss"),(0,k.savePreference)("is_new_reader",!1)},handleManageLinkClick:function(){return(0,S.recordTrack)("calypso_reader_following_intro_link_clicked"),(0,k.savePreference)("is_new_reader",!1)}},e)})((0,_.localize)(I)),e.exports=t.default},"./client/reader/following/main.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){(0,g.recordTrack)("calypso_reader_search_from_following",{query:e}),""!==(0,c.trim)(e)&&(0,d.default)("/read/search?q="+encodeURIComponent(e)+"&focus=1")}Object.defineProperty(t,"__esModule",{value:!0});var a=s("./node_modules/react/react.js"),n=o(a),l=s("./node_modules/i18n-calypso/index.js"),i=s("./node_modules/page/index.js"),d=o(i),c=s("./node_modules/lodash/lodash.js"),u=s("./client/reader/stream/index.jsx"),p=o(u),f=s("./client/components/card/compact.jsx"),m=o(f),h=s("./client/components/search/index.jsx"),_=o(h),g=s("./client/reader/stats.js"),b=s("./client/reader/search-stream/suggestion.jsx"),v=o(b),y=s("./client/reader/search-stream/suggestion-provider.jsx"),j=o(y),x=s("./client/reader/following/intro.jsx"),k=o(x),P=s("./client/config/index.js"),S=o(P),w=function(e){var t=e.suggestions&&(0,c.initial)((0,c.flatMap)(e.suggestions,function(e){return[n.default.createElement(v.default,{suggestion:e.text,source:"following",railcar:e.railcar}),", "]}));return n.default.createElement(p.default,e,S.default.isEnabled("reader/following-intro")&&n.default.createElement(k.default,null),n.default.createElement(m.default,{className:"following__search"},n.default.createElement(_.default,{onSearch:r,autoFocus:!1,delaySearch:!0,delayTimeout:500,placeholder:e.translate("Search billions of WordPress posts")})),n.default.createElement("div",{className:"search-stream__blank-suggestions"},t&&e.translate("Suggestions: {{suggestions /}}.",{components:{suggestions:t}}),""))};t.default=(0,j.default)((0,l.localize)(w)),e.exports=t.default},"./client/reader/full-post/controller.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(){var e=c.default.translate("Post not found");(0,_.setPageTitle)(context,e),(0,v.renderWithReduxStore)(i.default.createElement(h.default,{sidebarTitle:e,message:c.default.translate("Post Not Found")}),document.getElementById("primary"),context.store)}function a(e){var t=e.params.blog,s=e.params.post,o="/read/blogs/:blog_id/posts/:post_id",a=y+" > Blog Post > "+t+" > "+s,n=void 0;e.query.ref_blog&&e.query.ref_post&&(n={blogId:e.query.ref_blog,postId:e.query.ref_post}),(0,_.trackPageLoad)(o,a,"full_post"),(0,v.renderWithReduxStore)(i.default.createElement(b.default,{require:x,blogId:t,postId:s,referral:n,referralStream:e.lastRoute,onClose:function(){p.default.back(e.lastRoute||"/")},onPostNotFound:r}),document.getElementById("primary"),e.store),j()}function n(e){function t(){p.default.back(e.lastRoute||"/")}var s=e.params.feed,o=e.params.post,a="/read/feeds/:feed_id/posts/:feed_item_id",n=y+" > Feed Post > "+s+" > "+o;(0,_.trackPageLoad)(a,n,"full_post"),(0,v.renderWithReduxStore)(i.default.createElement(b.default,{require:k,feedId:s,postId:o,onClose:t,referralStream:e.lastRoute,onPostNotFound:r}),document.getElementById("primary"),e.store),j()}Object.defineProperty(t,"__esModule",{value:!0}),t.blogPost=a,t.feedPost=n;var l=s("./node_modules/react/react.js"),i=o(l),d=s("./node_modules/i18n-calypso/index.js"),c=o(d),u=s("./node_modules/page/index.js"),p=o(u),f=s("./node_modules/lodash/lodash.js"),m=s("./client/reader/feed-error/index.jsx"),h=o(m),_=s("./client/reader/controller-helper.js"),g=s("./client/components/async-load/index.jsx"),b=o(g),v=s("./client/lib/react-helpers/index.js"),y="Reader",j=function(){return(0,f.defer)(function(){"undefined"==typeof window||window.location.hash||window.scrollTo(0,0)})},x=function(e){s.e("async-load-blocks-reader-full-post").then(function(t){e(s("./client/blocks/reader-full-post/index.jsx").__esModule?s("./client/blocks/reader-full-post/index.jsx").default:s("./client/blocks/reader-full-post/index.jsx"))}.bind(null,s)).catch(s.oe)},k=function(e){s.e("async-load-blocks-reader-full-post").then(function(t){e(s("./client/blocks/reader-full-post/index.jsx").__esModule?s("./client/blocks/reader-full-post/index.jsx").default:s("./client/blocks/reader-full-post/index.jsx"))}.bind(null,s)).catch(s.oe)}},"./client/reader/full-post/index.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){(0,a.default)("/read/feeds/:feed/posts/:post",l.updateLastRoute,l.unmountSidebar,n.feedPost),(0,a.default)("/read/blogs/:blog/posts/:post",l.updateLastRoute,l.unmountSidebar,n.blogPost)};var r=s("./node_modules/page/index.js"),a=o(r),n=s("./client/reader/full-post/controller.js"),l=s("./client/reader/controller.js");e.exports=t.default},"./client/reader/index.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){e.params.team="a8c",t()}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){d.default.isEnabled("reader")&&((0,n.default)("/",l.preloadReaderBundle,l.initAbTests,l.updateLastRoute,l.sidebar,l.following),(0,n.default)("/read/following","/"),(0,n.default)("/read","/"),(0,n.default)("/read/blogs","/"),(0,n.default)("/read/feeds","/"),(0,n.default)("/read/blog","/"),(0,n.default)("/read/post","/"),(0,n.default)("/read/feed","/"),(0,n.default)("/read/*",l.preloadReaderBundle,l.initAbTests),(0,n.default)("/read/blog/feed/:feed_id",l.legacyRedirects),(0,n.default)("/read/feeds/:feed_id/posts",l.incompleteUrlRedirects),(0,n.default)("/read/feeds/:feed_id",l.updateLastRoute,l.prettyRedirects,l.sidebar,l.feedDiscovery,l.feedListing),(0,n.default)("/read/blog/id/:blog_id",l.legacyRedirects),(0,n.default)("/read/blogs/:blog_id/posts",l.incompleteUrlRedirects),(0,n.default)("/read/blogs/:blog_id",l.updateLastRoute,l.prettyRedirects,l.sidebar,l.blogListing),(0,n.default)("/read/post/feed/:feed_id/:post_id",l.legacyRedirects),(0,n.default)("/read/post/id/:blog_id/:post_id",l.legacyRedirects)),(0,n.default)("/read/a8c",l.updateLastRoute,l.sidebar,r,l.readA8C)};var a=s("./node_modules/page/index.js"),n=o(a),l=s("./client/reader/controller.js"),i=s("./client/config/index.js"),d=o(i);e.exports=t.default},"./client/reader/liked-stream/controller.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.likes=void 0;var r=s("./node_modules/react/react.js"),a=o(r),n=s("./client/lib/route/index.js"),l=o(n),i=s("./client/lib/feed-stream-store/index.js"),d=o(i),c=s("./client/reader/controller-helper.js"),u=s("./client/reader/liked-stream/main.jsx"),p=o(u),f=s("./client/lib/react-helpers/index.js"),m="Reader",h={likes:function(e){var t=l.default.sectionify(e.path),s=m+" > My Likes",o=(0,d.default)("likes"),r="postlike";(0,c.ensureStoreLoading)(o,e),(0,c.trackPageLoad)(t,s,r),(0,f.renderWithReduxStore)(a.default.createElement(p.default,{key:"liked",postsStore:o,trackScrollPage:c.trackScrollPage.bind(null,t,s,m,r),onUpdatesShown:c.trackUpdatesLoaded.bind(null,r)}),document.getElementById("primary"),e.store)}};t.default=h;var _=h.likes;t.likes=_},"./client/reader/liked-stream/empty.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),a=o(r),n=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/createClass.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/inherits.js"),f=o(p),m=s("./node_modules/react/react.js"),h=o(m),_=s("./node_modules/i18n-calypso/index.js"),g=s("./client/components/empty-content/index.jsx"),b=o(g),v=s("./client/reader/stats.js"),y=s("./client/reader/discover/helper.js"),j=function(e){function t(){var e,s,o,r;(0,l.default)(this,t);for(var n=arguments.length,i=Array(n),d=0;d<n;d++)i[d]=arguments[d];return s=o=(0,u.default)(this,(e=t.__proto__||(0,a.default)(t)).call.apply(e,[this].concat(i))),o.recordAction=function(){(0,v.recordAction)("clicked_following_on_empty_likes"),(0,v.recordGaEvent)("Clicked Following on Empty Like Stream"),(0,v.recordTrack)("calypso_reader_following_on_empty_like_stream_clicked")},o.recordSecondaryAction=function(){(0,v.recordAction)("clicked_discover_on_empty_likes"),(0,v.recordGaEvent)("Clicked Discover on Empty Like Stream"),(0,v.recordTrack)("calypso_reader_discover_on_empty_like_stream_clicked")},r=s,(0,u.default)(o,r)}return(0,f.default)(t,e),(0,d.default)(t,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){var e=h.default.createElement("a",{className:"empty-content__action button is-primary",onClick:this.recordAction,href:"/"},this.props.translate("Back to Following")),t=(0,y.isDiscoverEnabled)()?h.default.createElement("a",{className:"empty-content__action button",onClick:this.recordSecondaryAction,href:"/discover"},this.props.translate("Explore Discover")):null;return h.default.createElement(b.default,{title:this.props.translate("No Likes Yet"),line:this.props.translate("Posts that you like will appear here."),action:e,secondaryAction:t,illustration:"/calypso/images/illustrations/illustration-empty-results.svg",illustrationWidth:400})}}]),t}(h.default.Component);t.default=(0,_.localize)(j),e.exports=t.default},"./client/reader/liked-stream/index.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){(0,a.default)("/activities/likes",l.preloadReaderBundle,l.initAbTests,l.updateLastRoute,l.sidebar,n.likes)};var r=s("./node_modules/page/index.js"),a=o(r),n=s("./client/reader/liked-stream/controller.js"),l=s("./client/reader/controller.js");e.exports=t.default},"./client/reader/liked-stream/main.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/helpers/extends.js"),a=o(r),n=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/createClass.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),f=o(p),m=s("./node_modules/babel-runtime/helpers/inherits.js"),h=o(m),_=s("./node_modules/react/react.js"),g=o(_),b=s("./node_modules/i18n-calypso/index.js"),v=s("./client/reader/stream/index.jsx"),y=o(v),j=s("./client/reader/liked-stream/empty.jsx"),x=o(j),k=s("./client/components/data/document-head/index.jsx"),P=o(k),S=function(e){function t(){return(0,d.default)(this,t),(0,f.default)(this,(t.__proto__||(0,l.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=this.props.translate("My Likes"),t=g.default.createElement(x.default,null);return g.default.createElement(y.default,(0,a.default)({},this.props,{listName:e,emptyContent:t,showFollowInHeader:!0}),g.default.createElement(P.default,{title:this.props.translate("%s  Reader",{args:e})}))}}]),t}(g.default.Component);t.default=(0,b.localize)(S),e.exports=t.default},"./client/reader/list-gap/index.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),a=o(r),n=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/createClass.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/inherits.js"),f=o(p),m=s("./node_modules/prop-types/index.js"),h=o(m),_=s("./node_modules/react/react.js"),g=o(_),b=s("./node_modules/classnames/index.js"),v=o(b),y=s("./node_modules/i18n-calypso/index.js"),j=s("./client/reader/utils.js"),x=function(e){function t(){var e,s,o,r;(0,l.default)(this,t);for(var n=arguments.length,i=Array(n),d=0;d<n;d++)i[d]=arguments[d];return s=o=(0,u.default)(this,(e=t.__proto__||(0,a.default)(t)).call.apply(e,[this].concat(i))),o.state={isFilling:!1},o.handleClick=function(){o.setState({isFilling:!0}),(0,j.handleGapClicked)(o.props.gap,o.props.store.id)},r=s,(0,u.default)(o,r)}return(0,f.default)(t,e),(0,d.default)(t,[{key:"render",value:function(){var e=(0,v.default)({"reader-list-gap":!0,"is-filling":this.state.isFilling,"is-selected":this.props.selected}),t=this.props.translate;return g.default.createElement("div",{className:e,onClick:this.handleClick},g.default.createElement("button",{type:"button",className:"button reader-list-gap__button"},t("Load More Posts")))}}]),t}(g.default.Component);x.propTypes={gap:h.default.object.isRequired,store:h.default.object.isRequired,selected:h.default.bool},t.default=(0,y.localize)(x),e.exports=t.default},"./client/reader/list/controller.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.listListing=void 0;var r=s("./node_modules/react/react.js"),a=o(r),n=s("./client/lib/feed-stream-store/index.js"),l=o(n),i=s("./client/reader/stats.js"),d=s("./client/reader/controller-helper.js"),c=s("./client/lib/react-helpers/index.js"),u=s("./client/components/async-load/index.jsx"),p=o(u),f="Reader",m=function(e){s.e("async-load-reader-list-stream").then(function(t){e(s("./client/reader/list-stream/index.jsx").__esModule?s("./client/reader/list-stream/index.jsx").default:s("./client/reader/list-stream/index.jsx"))}.bind(null,s)).catch(s.oe)},h={listListing:function(e){var t="/read/list/:owner/:slug",s=f+" > List > "+e.params.user+" - "+e.params.list,o=(0,l.default)("list:"+e.params.user+"-"+e.params.list),r="list";(0,d.ensureStoreLoading)(o,e),(0,d.trackPageLoad)(t,s,r),(0,i.recordTrack)("calypso_reader_list_loaded",{list_owner:e.params.user,list_slug:e.params.list}),(0,c.renderWithReduxStore)(a.default.createElement(p.default,{require:m,key:"tag-"+e.params.user+"-"+e.params.list,postsStore:o,owner:encodeURIComponent(e.params.user),slug:encodeURIComponent(e.params.list),showPrimaryFollowButtonOnCards:!1,trackScrollPage:d.trackScrollPage.bind(null,t,s,f,r),onUpdatesShown:d.trackUpdatesLoaded.bind(null,r)}),document.getElementById("primary"),e.store)}};t.default=h;var _=h.listListing;t.listListing=_},"./client/reader/list/index.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){(0,a.default)("/read/list/:user/:list",l.updateLastRoute,l.sidebar,n.listListing)};var r=s("./node_modules/page/index.js"),a=o(r),n=s("./client/reader/list/controller.js"),l=s("./client/reader/controller.js");e.exports=t.default},"./client/reader/recommendations/controller.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.recommendedPosts=void 0;var r=s("./node_modules/react/react.js"),a=o(r),n=s("./client/lib/track-scroll-page/index.js"),l=o(n),i=s("./client/reader/controller-helper.js"),d=s("./client/reader/recommendations/posts/index.jsx"),c=o(d),u=s("./client/lib/route/index.js"),p=o(u),f=s("./client/lib/feed-stream-store/index.js"),m=o(f),h=s("./client/lib/react-helpers/index.js"),_="Reader",g={recommendedPosts:function(e){var t=p.default.sectionify(e.path),s="",o=null,r="";switch(t){case"/recommendations/cold":s=_+" > Coldstart Posts",o=(0,m.default)("cold_posts"),r="coldstart_posts";break;case"/recommendations/cold1w":s=_+" > Coldstart+1w Posts",o=(0,m.default)("cold_posts_1w"),r="coldstart_posts_1w";break;case"/recommendations/cold2w":s=_+" > Coldstart+2w Posts",o=(0,m.default)("cold_posts_2w"),r="coldstart_posts_2w";break;case"/recommendations/cold4w":s=_+" > Coldstart+4w Posts",o=(0,m.default)("cold_posts_4w"),r="coldstart_posts_4w";break;case"/recommendations/coldtopics":s=_+" > Coldstart Diverse Posts",o=(0,m.default)("cold_posts_topics"),r="coldstart_posts_topics";break;default:s=_+" > Recommended Posts",o=(0,m.default)("custom_recs_posts_with_images"),r="custom_recs_posts_with_images"}(0,i.ensureStoreLoading)(o,e),(0,i.trackPageLoad)(t,s,r),(0,h.renderWithReduxStore)(a.default.createElement(c.default,{key:"recommendations_posts",postsStore:o,trackScrollPage:l.default.bind(null,t,s,_,r),onUpdatesShown:i.trackUpdatesLoaded.bind(null,r),showBack:(0,i.userHasHistory)(e)}),document.getElementById("primary"),e.store)}};t.default=g;var b=g.recommendedPosts;t.recommendedPosts=b},"./client/reader/recommendations/index.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){(0,a.default)("/recommendations/start","/"),(0,a.default)("/recommendations","/read/search"),c.default.isEnabled("reader/recommendations/posts")&&(0,n.forEach)(["/recommendations/posts","/recommendations/cold","/recommendations/cold1w","/recommendations/cold2w","/recommendations/cold4w","/recommendations/coldtopics"],function(e){a.default.apply(a.default,[e,i.preloadReaderBundle,i.updateLastRoute,i.sidebar,l.recommendedPosts])})};var r=s("./node_modules/page/index.js"),a=o(r),n=s("./node_modules/lodash/lodash.js"),l=s("./client/reader/recommendations/controller.js"),i=s("./client/reader/controller.js"),d=s("./client/config/index.js"),c=o(d);e.exports=t.default},"./client/reader/recommendations/posts/empty.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),a=o(r),n=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/createClass.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/inherits.js"),f=o(p),m=s("./node_modules/react/react.js"),h=o(m),_=s("./node_modules/i18n-calypso/index.js"),g=s("./client/components/empty-content/index.jsx"),b=o(g),v=s("./client/reader/stats.js"),y=s("./client/reader/discover/helper.js"),j=function(e){function t(){var e,s,o,r;(0,l.default)(this,t);for(var n=arguments.length,i=Array(n),d=0;d<n;d++)i[d]=arguments[d];return s=o=(0,u.default)(this,(e=t.__proto__||(0,a.default)(t)).call.apply(e,[this].concat(i))),o.recordAction=function(){(0,v.recordAction)("clicked_following_on_empty_recommended_posts"),(0,v.recordGaEvent)("Clicked Following on Empty Recommended Posts Stream"),(0,v.recordTrack)("calypso_reader_following_on_empty_Posts_stream_clicked")},o.recordSecondaryAction=function(){(0,v.recordAction)("clicked_discover_on_empty_recommended_posts"),(0,v.recordGaEvent)("Clicked Discover on Empty Recommended Posts Stream"),(0,v.recordTrack)("calypso_reader_discover_on_empty_Posts_stream_clicked")},r=s,(0,u.default)(o,r)}return(0,f.default)(t,e),(0,d.default)(t,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){var e=h.default.createElement("a",{className:"empty-content__action button is-primary",onClick:this.recordAction,href:"/"},this.props.translate("Back to Following")),t=(0,y.isDiscoverEnabled)()?h.default.createElement("a",{className:"empty-content__action button",onClick:this.recordSecondaryAction,href:"/discover"},this.props.translate("Explore Discover")):null;return h.default.createElement(b.default,{title:this.props.translate("No Post Recommendations yet"),line:this.props.translate("Posts we recommend based on your WordPress.com activity will appear here."),action:e,secondaryAction:t,illustration:"/calypso/images/illustrations/illustration-empty-results.svg",illustrationWidth:500})}}]),t}(h.default.Component);t.default=(0,_.localize)(j),e.exports=t.default},"./client/reader/recommendations/posts/index.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/helpers/extends.js"),a=o(r),n=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/createClass.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),f=o(p),m=s("./node_modules/babel-runtime/helpers/inherits.js"),h=o(m),_=s("./node_modules/react/react.js"),g=o(_),b=s("./node_modules/i18n-calypso/index.js"),v=s("./client/reader/stream/index.jsx"),y=o(v),j=s("./client/reader/recommendations/posts/empty.jsx"),x=o(j),k=s("./client/components/data/document-head/index.jsx"),P=o(k),S=function(e){function t(){return(0,d.default)(this,t),(0,f.default)(this,(t.__proto__||(0,l.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=this.props.translate("Recommended Posts"),t=g.default.createElement(x.default,null);return g.default.createElement(y.default,(0,a.default)({},this.props,{listName:e,emptyContent:t,showFollowInHeader:!0}),g.default.createElement(P.default,{title:this.props.translate("%s  Reader",{args:e})}))}}]),t}(g.default.Component);t.default=(0,b.localize)(S),e.exports=t.default},"./client/reader/search-stream/search-stream-header.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.SEARCH_TYPES=void 0;var r=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),a=o(r),n=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/createClass.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/inherits.js"),f=o(p),m=s("./node_modules/prop-types/index.js"),h=o(m),_=s("./node_modules/react/react.js"),g=o(_),b=s("./node_modules/i18n-calypso/index.js"),v=s("./node_modules/lodash/lodash.js"),y=s("./client/components/section-nav/tabs.jsx"),j=o(y),x=s("./client/components/section-nav/index.jsx"),k=o(x),P=s("./client/components/section-nav/item.jsx"),S=o(P),w=t.SEARCH_TYPES={POSTS:"posts",SITES:"sites"},I=function(e){function t(){var e,s,o,r;(0,l.default)(this,t);for(var n=arguments.length,i=Array(n),d=0;d<n;d++)i[d]=arguments[d];return s=o=(0,u.default)(this,(e=t.__proto__||(0,a.default)(t)).call.apply(e,[this].concat(i))),o.handlePostsSelected=function(){return o.props.onSelection(w.POSTS)},o.handleSitesSelected=function(){return o.props.onSelection(w.SITES)},r=s,(0,u.default)(o,r)}return(0,f.default)(t,e),(0,d.default)(t,[{key:"render",value:function(){var e=this.props,t=e.translate,s=e.wideDisplay,o=e.selected;return s?g.default.createElement("ul",{className:"search-stream__headers"},g.default.createElement("li",{className:"search-stream__post-header"},t("Posts")),g.default.createElement("li",{className:"search-stream__site-header"},t("Sites"))):g.default.createElement("div",{className:"search-stream__header"},g.default.createElement(k.default,null,g.default.createElement(j.default,null,g.default.createElement(S.default,{key:"posts-nav",selected:o===w.POSTS,onClick:this.handlePostsSelected},t("Posts")),g.default.createElement(S.default,{key:"sites-nav",selected:o===w.SITES,onClick:this.handleSitesSelected},t("Sites")))))}}]),t}(_.Component);I.propTypes={translate:h.default.func,wideDisplay:h.default.bool,selected:h.default.oneOf((0,v.values)(w)),onSelection:h.default.func},I.defaultProps={onSelection:v.noop,selected:w.posts},t.default=(0,b.localize)(I)},"./client/reader/search-stream/suggestion-provider.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){return t?t.length<=e?[]:(0,j.map)((0,j.sampleSize)(t,e),function(e,t){var s=(e.displayName||e.slug).replace(/-/g," "),o="read:search-suggestions:tags/1";return n(s,o,t)}):null}function a(e){var t=k.default.getLocaleSlug().split("-")[0];return P.suggestions[t]?(0,j.map)((0,j.sampleSize)(P.suggestions[t],e),function(e,t){var s="read:search-suggestions:picks/1";return n(e,s,t)}):null}function n(e,t,s){return{text:e,railcar:{railcar:C.default.tracks.createRandomId()+"-"+s,ui_algo:t,ui_position:s,rec_result:e}}}function l(e,t){var s=r(e,t);if(null===s)return null;var o=s.length?s:a(e);return o}Object.defineProperty(t,"__esModule",{value:!0});var i=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/createClass.js"),f=o(p),m=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),h=o(m),_=s("./node_modules/babel-runtime/helpers/inherits.js"),g=o(_),b=s("./node_modules/react-redux/es/index.js"),v=s("./node_modules/react/react.js"),y=o(v),j=s("./node_modules/lodash/lodash.js"),x=s("./client/lib/i18n-utils/browser.js"),k=o(x),P=s("./client/reader/search-stream/suggestions.js"),S=s("./client/state/selectors/get-reader-followed-tags.js"),w=o(S),I=s("./client/lib/analytics/index.js"),C=o(I),E=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return function(s){function o(){var s,r,a,n;(0,u.default)(this,o);for(var i=arguments.length,c=Array(i),p=0;p<i;p++)c[p]=arguments[p];return r=a=(0,h.default)(this,(s=o.__proto__||(0,d.default)(o)).call.apply(s,[this].concat(c))),a.memoizedSuggestions=null,a.getFirstSuggestions=function(e){return a.memoizedSuggestions?a.memoizedSuggestions:a.memoizedSuggestions=l(t,(0,w.default)(e))},a.EnhancedComponent=(0,b.connect)(function(e){return{suggestions:a.getFirstSuggestions(e)}})(e),n=r,(0,h.default)(a,n)}return(0,g.default)(o,s),(0,f.default)(o,[{key:"componentWillUnmount",value:function(){this.memoizedSuggestions=null}},{key:"render",value:function(){var e=this.EnhancedComponent;return y.default.createElement(e,this.props)}}]),o}(v.Component)};t.default=E,e.exports=t.default},"./client/reader/search-stream/suggestion.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Suggestion=void 0;var r=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),a=o(r),n=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/createClass.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/inherits.js"),f=o(p),m=s("./node_modules/react/react.js"),h=o(m),_=s("./node_modules/prop-types/index.js"),g=o(_),b=s("./node_modules/qs/lib/index.js"),v=s("./client/reader/stats.js"),y=s("./client/lib/analytics/index.js"),j=o(y),x=t.Suggestion=function(e){function t(){var e,s,o,r;(0,l.default)(this,t);for(var n=arguments.length,i=Array(n),d=0;d<n;d++)i[d]=arguments[d];return s=o=(0,u.default)(this,(e=t.__proto__||(0,a.default)(t)).call.apply(e,[this].concat(i))),o.handleSuggestionClick=function(){var e=o.props,t=e.suggestion,s=e.source,r=e.railcar;(0,v.recordTrack)("calypso_reader_search_suggestion_click",{suggestion:t,source:s}),(0,v.recordTracksRailcarInteract)("search_suggestion_click",r)},r=s,(0,u.default)(o,r)}return(0,f.default)(t,e),(0,d.default)(t,[{key:"componentWillMount",value:function(){var e=this.props.railcar;j.default.tracks.recordEvent("calypso_traintracks_render",e)}},{key:"render",value:function(){var e=this.props,t=e.suggestion,s=e.sort,o={isSuggestion:1,q:t,sort:s},r="/read/search?"+(0,b.stringify)(o);return h.default.createElement("a",{onClick:this.handleSuggestionClick,href:r},t)}}]),t}(m.Component);x.propTypes={suggestion:g.default.string.isRequired,source:g.default.string,sort:g.default.string,railcar:g.default.object},t.default=x},"./client/reader/search-stream/suggestions.js":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.suggestions={en:["Anime","Art","Astrology","Batman","Beach","Beautiful","Beauty","Bloom","Books","Chickens","Cocktails","Colorado","Community Pool","Craft Beer","Cute","Delicious","DIY","Dogs","Elasticsearch","Fabulous","Farm","Fashion","Fitness","Flowers","Food","Funny","Garden","Groovy","Happy Place","Health","Hiking","Homeschool","Homesteading","Iceland","Inspiration","Juno","Life","Love","Makeup","Mathematics","Michigan","Monkeys","Motivation","Mountain Biking","Overwatch","Parenting","Philosophy","Photography","Poetry","Politics","Pride","Psychology","Recipe","Red Sox","Robots","Scenic","Sharks","Sous vide","Sunday Brunch","Technology","Tibet","Toddlers","Travel Backpacks","Travel","Vegan","Woodworking","WordPress","Writing","Yoga","Zombies"],
es:["amor","arte","cine","fotografia","libros","literatura","moda","musica","poesia","viajes"],fr:["amour","art","beaut","beauty","fashion","lifestyle","livres","maquillage","mode","photo","photographie","recette","vegan","voyage"],de:["beauty","bcher","diy","essen","fashion","food","foto","kinder","mode","politik","reisen","vegan"]}},"./client/reader/search/controller.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var s="/read/search";e&&(s+="?"+c.default.stringify({q:e,sort:t})),i.default.replace(s)}Object.defineProperty(t,"__esModule",{value:!0}),t.search=void 0;var a=s("./node_modules/react/react.js"),n=o(a),l=s("./node_modules/page/index.js"),i=o(l),d=s("./node_modules/qs/lib/index.js"),c=o(d),u=s("./client/lib/feed-stream-store/index.js"),p=o(u),f=s("./client/reader/stats.js"),m=s("./client/reader/controller-helper.js"),h=s("./client/lib/react-helpers/index.js"),_=s("./client/components/async-load/index.jsx"),g=o(_),b=s("./client/reader/search-stream/search-stream-header.jsx"),v="Reader",y=function(e){s.e("async-load-reader-search-stream").then(function(t){e(s("./client/reader/search-stream/index.jsx").__esModule?s("./client/reader/search-stream/index.jsx").default:s("./client/reader/search-stream/index.jsx"))}.bind(null,s)).catch(s.oe)},j={search:function(e){function t(e){r(e,"relevance"!==c?c:void 0)}function s(e){r(u,"relevance"!==e?e:void 0)}var o="/read/search",a=v+" > Search",l="search",i=e.query,d=i.sort,c=void 0===d?"relevance":d,u=i.q,_=i.show,j=void 0===_?b.SEARCH_TYPES.POSTS:_,x=void 0;u?(x=(0,p.default)("search:"+c+":"+u),x.isQuerySuggestion="1"===e.query.isSuggestion,(0,m.ensureStoreLoading)(x,e)):(x=(0,p.default)("custom_recs_posts_with_images"),(0,m.ensureStoreLoading)(x,e)),(0,m.trackPageLoad)(o,a,l),u?(0,f.recordTrack)("calypso_reader_search_performed",{query:u,sort:c}):(0,f.recordTrack)("calypso_reader_search_loaded");var k=!u||"1"===e.query.focus;(0,h.renderWithReduxStore)(n.default.createElement(g.default,{require:y,key:"search",postsStore:x,query:u,trackScrollPage:m.trackScrollPage.bind(null,o,a,v,l),onUpdatesShown:m.trackUpdatesLoaded.bind(null,l),showBack:!1,showPrimaryFollowButtonOnCards:!0,autoFocusInput:k,onQueryChange:t,onSortChange:s,searchType:j}),document.getElementById("primary"),e.store)}};t.default=j;var x=j.search;t.search=x},"./client/reader/search/index.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){l.default.isEnabled("reader/search")?(0,a.default)("/read/search",d.preloadReaderBundle,d.updateLastRoute,d.sidebar,i.search):a.default.redirect("/read/search","/")};var r=s("./node_modules/page/index.js"),a=o(r),n=s("./client/config/index.js"),l=o(n),i=s("./client/reader/search/controller.js"),d=s("./client/reader/controller.js");e.exports=t.default},"./client/reader/stream/empty-search-recommended-post.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){function t(){(0,i.recordTrackForPost)("calypso_reader_recommended_post_clicked",o,{recommendation_source:"empty-search"}),(0,i.recordAction)("search_page_rec_post_click")}function s(){(0,i.recordTrackForPost)("calypso_reader_recommended_site_clicked",o,{recommendation_source:"empty-search"}),(0,i.recordAction)("search_page_rec_site_click")}var o=e.post,r={title:o.site_name};return n.default.createElement("div",{className:"search-stream__recommendation-list-item",key:o.global_ID},n.default.createElement(l.RelatedPostCard,{post:o,site:r,onSiteClick:s,onPostClick:t,followSource:d.EMPTY_SEARCH_RECOMMENDATIONS}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var a=s("./node_modules/react/react.js"),n=o(a),l=s("./client/blocks/reader-related-card-v2/index.jsx"),i=s("./client/reader/stats.js"),d=s("./client/reader/follow-button/follow-sources.jsx");e.exports=t.default},"./client/reader/stream/empty.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),a=o(r),n=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/createClass.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/inherits.js"),f=o(p),m=s("./node_modules/react/react.js"),h=o(m),_=s("./node_modules/i18n-calypso/index.js"),g=s("./client/components/empty-content/index.jsx"),b=o(g),v=s("./client/reader/stats.js"),y=function(e){function t(){var e,s,o,r;(0,l.default)(this,t);for(var n=arguments.length,i=Array(n),d=0;d<n;d++)i[d]=arguments[d];return s=o=(0,u.default)(this,(e=t.__proto__||(0,a.default)(t)).call.apply(e,[this].concat(i))),o.recordAction=function(){(0,v.recordAction)("clicked_search_on_empty"),(0,v.recordGaEvent)("Clicked Search on EmptyContent"),(0,v.recordTrack)("calypso_reader_search_on_empty_stream_clicked")},r=s,(0,u.default)(o,r)}return(0,f.default)(t,e),(0,d.default)(t,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){var e=h.default.createElement("a",{className:"empty-content__action button is-primary",onClick:this.recordAction,href:"/read/search"},this.props.translate("Find Sites to Follow")),t=null;return h.default.createElement(b.default,{className:"stream__empty",title:this.props.translate("Welcome to Reader"),line:this.props.translate("Recent posts from sites you follow will appear here."),action:e,secondaryAction:t,illustration:"/calypso/images/reader/reader-welcome-illustration.svg",illustrationWidth:380})}}]),t}(h.default.Component);t.default=(0,_.localize)(y),e.exports=t.default},"./client/reader/stream/index.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){if(e<=0)return _e;var t=(0,S.clamp)(Math.floor(Math.log(e)*Math.LOG2E*5-6),he,_e);return t}Object.defineProperty(t,"__esModule",{value:!0});var a=s("./node_modules/babel-runtime/helpers/extends.js"),n=o(a),l=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),i=o(l),d=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),c=o(d),u=s("./node_modules/babel-runtime/helpers/createClass.js"),p=o(u),f=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),m=o(f),h=s("./node_modules/babel-runtime/helpers/inherits.js"),_=o(h),g=s("./node_modules/react-dom/index.js"),b=o(g),v=s("./node_modules/prop-types/index.js"),y=o(v),j=s("./node_modules/react/react.js"),x=o(j),k=s("./node_modules/classnames/index.js"),P=o(k),S=s("./node_modules/lodash/lodash.js"),w=s("./node_modules/react-redux/es/index.js"),I=s("./node_modules/i18n-calypso/index.js"),C=s("./client/components/reader-main/index.jsx"),E=o(C),R=s("./client/reader/stream/empty.jsx"),M=o(R),N=s("./client/lib/feed-stream-store/actions.js"),L=s("./client/lib/like-store/like-store.js"),T=o(L),F=s("./client/lib/like-store/actions.js"),D=o(F),H=s("./client/reader/like-helper.jsx"),A=o(H),O=s("./client/components/list-end/index.js"),U=o(O),B=s("./client/components/infinite-list/index.jsx"),K=o(B),q=s("./client/components/mobile-back-to-sidebar/index.jsx"),W=o(q),G=s("./client/reader/stream/post-placeholder.jsx"),V=o(G),z=s("./client/lib/feed-post-store/index.js"),X=o(z),Y=s("./client/reader/update-notice/index.jsx"),$=o(Y),Q=s("./client/lib/keyboard-shortcuts/index.js"),J=o(Q),Z=s("./client/lib/scroll-to/index.js"),ee=o(Z),te=s("./client/reader/xpost-helper.js"),se=o(te),oe=s("./client/reader/stream/post-lifecycle.jsx"),re=o(oe),ae=s("./client/reader/utils.js"),ne=s("./client/state/selectors/get-blocked-sites.js"),le=o(ne),ie=s("./client/state/selectors/get-reader-follows.js"),de=o(ie),ce=s("./client/lib/feed-stream-store/post-key.js"),ue=s("./client/state/ui/reader/card-expansions/actions.js"),pe=s("./client/reader/stream/utils.js"),fe=600,me=46,he=4,_e=30,ge=function(e){function t(){var e,s,o,r;(0,c.default)(this,t);for(var a=arguments.length,n=Array(a),l=0;l<a;l++)n[l]=arguments[l];return s=o=(0,m.default)(this,(e=t.__proto__||(0,i.default)(t)).call.apply(e,[this].concat(n))),be.call(o),r=s,(0,m.default)(o,r)}return(0,_.default)(t,e),(0,p.default)(t,[{key:"getStateFromStores",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=e.postsStore,s=e.recommendationsStore,o=e.totalSubs,a=(0,S.map)(t.get(),e.transformStreamItems),n=s?s.get():null;s&&(!n||n.length<a.length*(pe.RECS_PER_BLOCK/r(o)))&&(s.isFetchingNextPage()||(0,S.defer)(function(){return(0,N.fetchNextPage)(s.id)}));var l=this.state&&this.state.items;return this.state&&a===this.state.posts&&n===this.state.recs||(l=(0,pe.injectRecommendations)(a,n,r(o))),e.shouldCombineCards&&(l=(0,pe.combineCards)(l)),{items:l,posts:a,recs:n,updateCount:t.getUpdateCount(),selectedPostKey:t.getSelectedPostKey(),isFetchingNextPage:t.isFetchingNextPage&&t.isFetchingNextPage(),isLastPage:t.isLastPage()}}},{key:"componentDidUpdate",value:function(e,t){(0,ce.keysAreEqual)(t.selectedPostKey,this.state.selectedPostKey)||(this.scrollToSelectedPost(!0),this.isPostFullScreen()&&(0,ae.showSelectedPost)({store:this.props.postsStore,replaceHistory:!0}))}},{key:"scrollToSelectedPost",value:function(e){var t=-80,s=b.default.findDOMNode(this).querySelector(".is-selected");if(s){var o=document.documentElement;s.focus();var r=(window.pageYOffset||o.scrollTop)-(o.clientTop||0),a=s.getBoundingClientRect(),n=parseInt(r+a.top+t,10);e?(0,ee.default)({x:0,y:n,duration:200}):window.scrollTo(0,n)}}},{key:"componentDidMount",value:function(){this.props.postsStore.on("change",this.updateState),this.props.recommendationsStore&&this.props.recommendationsStore.on("change",this.updateState),this.props.resetCardExpansions(),J.default.on("move-selection-down",this.selectNextItem),J.default.on("move-selection-up",this.selectPrevItem),J.default.on("open-selection",this.handleOpenSelection),J.default.on("like-selection",this.toggleLikeOnSelectedPost),J.default.on("go-to-top",this.goToTop),window.addEventListener("popstate",this._popstate),"scrollRestoration"in history&&(history.scrollRestoration="manual")}},{key:"componentWillUnmount",value:function(){this.props.postsStore.off("change",this.updateState),this.props.recommendationsStore&&this.props.recommendationsStore.off("change",this.updateState),J.default.off("move-selection-down",this.selectNextItem),J.default.off("move-selection-up",this.selectPrevItem),J.default.off("open-selection",this.handleOpenSelection),J.default.off("like-selection",this.toggleLikeOnSelectedPost),J.default.off("go-to-top",this.goToTop),window.removeEventListener("popstate",this._popstate),"scrollRestoration"in history&&(history.scrollRestoration="auto")}},{key:"componentWillReceiveProps",value:function(e){e.postsStore!==this.props.postsStore&&(this.props.postsStore.off("change",this.updateState),this.props.recommendationsStore&&this.props.recommendationsStore.off("change",this.updateState),e.postsStore.on("change",this.updateState),e.recommendationsStore&&e.recommendationsStore.on("change",this.updateState),this.props.resetCardExpansions(),this.updateState(e),this._list&&this._list.reset())}},{key:"toggleLikeAction",value:function(e,t){var s=T.default.isPostLikedByCurrentUser(e,t);null!==s&&D.default[s?"unlikePost":"likePost"](e,t)}},{key:"isPostFullScreen",value:function(){return!!window.location.pathname.match(/^\/read\/(blogs|feeds)\/([0-9]+)\/posts\/([0-9]+)$/i)}},{key:"getVisibleItemIndexes",value:function(){return this._list&&this._list.getVisibleItemIndexes({offsetTop:me})}},{key:"render",value:function(){var e=this,t=this.props.postsStore,s=t.isLastPage()&&(!this.state.posts||0===this.state.posts.length),o=void 0,r=void 0;s||t.hasRecentError("invalid_tag")?(o=this.props.emptyContent,!o&&this.props.showDefaultEmptyContentIfMissing&&(o=x.default.createElement(M.default,null)),r=!1):(o=x.default.createElement(K.default,{ref:function(t){return e._list=t},className:"reader__content",items:this.state.items,lastPage:this.state.isLastPage,fetchingNextPage:this.state.isFetchingNextPage,guessedItemHeight:fe,fetchNextPage:this.fetchNextPage,getItemRef:this.getPostRef,renderItem:this.renderPost,renderLoadingPlaceholders:this.renderLoadingPlaceholders}),r=!0);var a=this.props.isMain?E.default:"div";return x.default.createElement(a,{className:(0,P.default)("following",this.props.className)},this.props.isMain&&this.props.showMobileBackToSidebar&&x.default.createElement(W.default,null,x.default.createElement("h1",null,this.props.translate("Streams"))),x.default.createElement($.default,{count:this.state.updateCount,onClick:this.showUpdates}),this.props.children,r&&this.state.posts.length?this.props.intro:null,o,r&&t.isLastPage()&&this.state.posts.length?x.default.createElement(U.default,null):null)}}]),t}(x.default.Component);ge.propTypes={postsStore:y.default.object.isRequired,recommendationsStore:y.default.object,trackScrollPage:y.default.func.isRequired,suppressSiteNameLink:y.default.bool,showPostHeader:y.default.bool,showFollowInHeader:y.default.bool,onUpdatesShown:y.default.func,emptyContent:y.default.object,className:y.default.string,showDefaultEmptyContentIfMissing:y.default.bool,showPrimaryFollowButtonOnCards:y.default.bool,showMobileBackToSidebar:y.default.bool,placeholderFactory:y.default.func,followSource:y.default.string,isDiscoverStream:y.default.bool,shouldCombineCards:y.default.bool,useCompactCards:y.default.bool,transformStreamItems:y.default.func,isMain:y.default.bool,intro:y.default.object},ge.defaultProps={showPostHeader:!0,suppressSiteNameLink:!1,showFollowInHeader:!1,onUpdatesShown:S.noop,className:"",showDefaultEmptyContentIfMissing:!0,showPrimaryFollowButtonOnCards:!0,showMobileBackToSidebar:!0,isDiscoverStream:!1,shouldCombineCards:!0,transformStreamItems:S.identity,isMain:!0,useCompactCards:!1,intro:null};var be=function(){var e=this;this.state=this.getStateFromStores(),this.updateState=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.props;e.setState(e.getStateFromStores(t))},this._popstate=function(){e.state.selectedPostKey&&"manual"!==history.scrollRestoration&&e.scrollToSelectedPost(!1)},this.handleOpenSelection=function(){var t=e.props.postsStore.getSelectedPostKey();(0,ae.showSelectedPost)({store:e.props.postsStore,postKey:t})},this.toggleLikeOnSelectedPost=function(){var t=e.props.postsStore.getSelectedPostKey(),s=void 0;t&&!t.isGap&&(s=X.default.get(t));var o=se.default.getXPostMetadata(s);return o.postURL?void(e.isPostFullScreen()&&o.blogId&&o.postId&&e.toggleLikeAction(o.blogId,o.postId)):void(A.default.shouldShowLikes(s)&&e.toggleLikeAction(s.site_ID,s.ID))},this.goToTop=function(){e.state.updateCount&&e.state.updateCount>0?e.showUpdates():(0,N.selectFirstItem)(e.props.postsStore.id)},this.selectNextItem=function(){if(e.state.selectedPostKey)return void(0,N.selectNextItem)(e.props.postsStore.id);var t=e.getVisibleItemIndexes(),s=e.state,o=s.items,r=s.posts;if(t&&t.length>0){for(var a=t[0].index,n=0;n<t.length;n++){var l=t[n];if(l.bounds.top>0&&!o[l.index].isRecommendationBlock){a=l.index;break}}var i=o[a];if(i.isCombination){var d={postId:i.postIds[0]};i.feedId?d.feedId=i.feedId:d.blogId=i.blogId,(0,N.selectItem)(e.props.postsStore.id,d)}var c=(0,S.findLast)(r,o[a],a);(0,ce.keysAreEqual)(c,e.state.selectedPostKey)?(0,N.selectNextItem)(e.props.postsStore.id):(0,N.selectItem)(e.props.postsStore.id,c)}},this.selectPrevItem=function(){e.state.selectedPostKey&&(0,N.selectPrevItem)(e.props.postsStore.id)},this.fetchNextPage=function(t){e.props.postsStore.isLastPage()||e.props.postsStore.isFetchingNextPage()||(t.triggeredByScroll&&e.props.trackScrollPage(e.props.postsStore.getPage()+1),(0,N.fetchNextPage)(e.props.postsStore.id))},this.showUpdates=function(){e.props.onUpdatesShown(),(0,N.showUpdates)(e.props.postsStore.id),e.props.recommendationsStore&&(0,N.shufflePosts)(e.props.recommendationsStore.id),e._list&&e._list.scrollToTop()},this.renderLoadingPlaceholders=function(){var t=e.state.posts.length?2:e.props.postsStore.getPerPage();return(0,S.times)(t,function(t){return e.props.placeholderFactory?e.props.placeholderFactory({key:"feed-post-placeholder-"+t}):x.default.createElement(V.default,{key:"feed-post-placeholder-"+t})})},this.getPostRef=function(e){return(0,ce.keyToString)(e)},this.renderPost=function(t,s){var o=e.props.recommendationsStore&&e.props.recommendationsStore.id,r=e.props.postsStore.getSelectedPostKey(),a=!(!r||r.postId!==t.postId||r.blogId!==t.blogId&&r.feedId!==t.feedId),l=e.getPostRef(t),i=function(s){return(0,ae.showSelectedPost)((0,n.default)({},s,{postKey:t.isCombination?(0,ce.keyForPost)(s):t,store:e.props.postsStore}))};return x.default.createElement(re.default,{key:l,ref:l,isSelected:a,handleClick:i,postKey:t,store:e.props.postsStore,suppressSiteNameLink:e.props.suppressSiteNameLink,showPostHeader:e.props.showPostHeader,showFollowInHeader:e.props.showFollowInHeader,showPrimaryFollowButtonOnCards:e.props.showPrimaryFollowButtonOnCards,isDiscoverStream:e.props.isDiscoverStream,showSiteName:e.props.showSiteNameOnCards,followSource:e.props.followSource,blockedSites:e.props.blockedSites,index:s,selectedPostKey:r,recStoreId:o,compact:e.props.useCompactCards})}};t.default=(0,I.localize)((0,w.connect)(function(e){return{blockedSites:(0,le.default)(e),totalSubs:(0,de.default)(e).length}},{resetCardExpansions:ue.resetCardExpansions})(ge)),e.exports=t.default},"./client/reader/stream/post-lifecycle.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/helpers/extends.js"),a=o(r),n=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/createClass.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),f=o(p),m=s("./node_modules/babel-runtime/helpers/inherits.js"),h=o(m),_=s("./node_modules/prop-types/index.js"),g=o(_),b=s("./node_modules/react/react.js"),v=o(b),y=s("./node_modules/lodash/lodash.js"),j=s("./client/lib/feed-post-store/index.js"),x=o(j),k=s("./client/lib/feed-post-store/actions.js"),P=o(k),S=s("./client/reader/stream/post-placeholder.jsx"),w=o(S),I=s("./client/reader/stream/post-unavailable.jsx"),C=o(I),E=s("./client/reader/list-gap/index.jsx"),R=o(E),M=s("./client/reader/stream/x-post.jsx"),N=o(M),L=s("./client/reader/utils.js"),T=s("./client/reader/stream/recommended-posts.jsx"),F=o(T),D=s("./client/reader/xpost-helper.js"),H=o(D),A=s("./client/blocks/reader-post-card/blocked.jsx"),O=o(A),U=s("./client/reader/stream/post.jsx"),B=o(U),K=s("./client/reader/follow-button/follow-sources.jsx"),q=s("./client/blocks/reader-combined-card/index.jsx"),W=o(q),G=s("./client/lib/reader-post-flux-adapter/index.js"),V=o(G),z=s("./client/reader/stream/empty-search-recommended-post.jsx"),X=o(z),Y=(0,V.default)(W.default),$=function(e){function t(){var e,s,o,r;(0,d.default)(this,t);for(var a=arguments.length,n=Array(a),i=0;i<a;i++)n[i]=arguments[i];return s=o=(0,f.default)(this,(e=t.__proto__||(0,l.default)(t)).call.apply(e,[this].concat(n))),o.state={post:o.getPostFromStore()},o.updatePost=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.props,t=o.getPostFromStore(e);t!==o.state.post&&o.setState({post:t})},r=s,(0,f.default)(o,r)}return(0,h.default)(t,e),(0,u.default)(t,[{key:"getPostFromStore",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;if(e.postKey.isRecommendationBlock||e.postKey.isCombination||e.postKey.isGap)return null;var t=x.default.get(e.postKey);return t&&"minimal"!==t._state||(0,y.defer)(function(){return P.default.fetchPost(e.postKey)}),t}},{key:"componentWillMount",value:function(){x.default.on("change",this.updatePost)}},{key:"componentWillUnmount",value:function(){x.default.off("change",this.updatePost)}},{key:"componentWillReceiveProps",value:function(e){this.updatePost(e)}},{key:"shouldComponentUpdate",value:function(e,t){var s=(0,y.omit)(this.props,"handleClick"),o=(0,y.omit)(e,"handleClick"),r=this.state.post!==t.post||!(0,L.shallowEquals)(s,o);return r}},{key:"render",value:function(){var e=this.state.post,t=this.props,s=t.postKey,o=t.selectedPostKey,r=t.recStoreId,n=t.followSource;if(s.isRecommendationBlock)return v.default.createElement(F.default,{recommendations:s.recommendations,index:s.index,storeId:r,followSource:K.IN_STREAM_RECOMMENDATION});if(s.isCombination)return v.default.createElement(Y,{postKey:s,index:this.props.index,onClick:this.props.handleClick,selectedPostKey:o,followSource:n,showFollowButton:this.props.showPrimaryFollowButtonOnCards});if(s.isRecommendation)return v.default.createElement(X.default,{post:e,site:s});if(s.isGap)return v.default.createElement(R.default,{gap:s,store:this.props.store,selected:this.props.isSelected,handleClick:this.props.handleClick});if(!e||"minimal"===e._state||"pending"===e._state)return v.default.createElement(w.default,null);if("error"===e._state)return v.default.createElement(C.default,{post:e});if(!e.is_external&&(0,y.includes)(this.props.blockedSites,+e.site_ID))return v.default.createElement(O.default,{post:e});if((0,D.isXPost)(e)){var l=H.default.getXPostMetadata(e),i=this.props.store.getSitesCrossPostedTo(l.commentURL||l.postURL);return v.default.createElement(N.default,(0,a.default)({},(0,y.omit)(this.props,"store"),{xPostedTo:i,xMetadata:l,post:e,postKey:s}))}var d=this.props.store.getSitesCrossPostedTo(e.URL);return v.default.createElement(B.default,(0,a.default)({},(0,y.omit)(this.props,"store"),{post:e,xPostedTo:d}))}}]),t}(v.default.Component);$.propTypes={postKey:g.default.object.isRequired,isDiscoverStream:g.default.bool,handleClick:g.default.func,recStoreId:g.default.string},t.default=$,e.exports=t.default},"./client/reader/stream/post-placeholder.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),a=o(r),n=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/createClass.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/inherits.js"),f=o(p),m=s("./node_modules/react/react.js"),h=o(m),_=s("./client/components/card/index.jsx"),g=o(_),b=function(e){function t(){return(0,l.default)(this,t),(0,u.default)(this,(t.__proto__||(0,a.default)(t)).apply(this,arguments))}return(0,f.default)(t,e),(0,d.default)(t,[{key:"render",value:function(){return h.default.createElement(g.default,{tagName:"article",className:"reader__card is-placeholder"},h.default.createElement("div",{className:"reader__post-header"},h.default.createElement("h1",{className:"reader__post-title"},h.default.createElement("a",{className:"reader__post-title-link",target:"_blank",rel:"noopener noreferrer"},h.default.createElement("span",{className:"reader__placeholder-text"},"Loading interesting posts"))),h.default.createElement("div",{className:"reader__post-byline"},h.default.createElement("span",{className:"site-icon",height:"16",width:"16"}),h.default.createElement("h4",{className:"reader__site-name"},h.default.createElement("span",{className:"reader__placeholder-text"},"Loading Sites")),h.default.createElement("div",{className:"reader__post-time-placeholder"},h.default.createElement("span",{className:"reader__placeholder-text"},"10 min")))),h.default.createElement("div",{className:"reader__post-excerpt"},h.default.createElement("p",null,h.default.createElement("span",{className:"reader__placeholder-text"},"Please wait while we grab all the interesting posts, photos, videos and more to show you in Reader. It shouldnt take long."))),h.default.createElement("ul",{className:"reader__post-footer"},h.default.createElement("li",{className:"reader__post-read-time"},h.default.createElement("span",{className:"reader__placeholder-text"},"10 min read"))))}}]),t}(h.default.PureComponent);t.default=b,e.exports=t.default},"./client/reader/stream/post-unavailable.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/core-js/json/stringify.js"),a=o(r),n=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/createClass.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),f=o(p),m=s("./node_modules/babel-runtime/helpers/inherits.js"),h=o(m),_=s("./node_modules/react/react.js"),g=o(_),b=s("./node_modules/i18n-calypso/index.js"),v=s("./client/config/index.js"),y=o(v),j=s("./client/components/card/index.jsx"),x=o(j),k=function(e){function t(){return(0,d.default)(this,t),(0,f.default)(this,(t.__proto__||(0,l.default)(t)).apply(this,arguments))}return(0,h.default)(t,e),(0,u.default)(t,[{key:"componentWillMount",value:function(){this.errors={unauthorized:this.props.translate("This is a post on a private site that youre following, but not currently a member of. Please request membership to display these posts in Reader."),default:this.props.translate("An error occurred loading this post.")}}},{key:"render",value:function(){var e=this.errors[this.props.post.errorCode||"default"]||this.errors.default;return 404===this.props.post.statusCode?null:g.default.createElement(x.default,{tagName:"article",className:"reader__card is-error"},g.default.createElement("div",{className:"reader__post-header"},g.default.createElement("h1",{className:"reader__post-title"},g.default.createElement("a",{className:"reader__post-title-link",target:"_blank",rel:"noopener noreferrer"},g.default.createElement("span",{className:"reader__placeholder-text"},"Oops!")))),g.default.createElement("div",{className:"reader__post-excerpt"},g.default.createElement("p",null,e),y.default.isEnabled("reader/full-errors")?g.default.createElement("pre",null,(0,a.default)(this.props.post,null,"  ")):null))}}]),t}(g.default.PureComponent);t.default=(0,b.localize)(k),e.exports=t.default},"./client/reader/stream/post.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/helpers/extends.js"),a=o(r),n=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/createClass.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),f=o(p),m=s("./node_modules/babel-runtime/helpers/inherits.js"),h=o(m),_=s("./node_modules/react/react.js"),g=o(_),b=s("./node_modules/react-redux/es/index.js"),v=s("./node_modules/lodash/lodash.js"),y=s("./client/blocks/reader-post-card/index.jsx"),j=o(y),x=s("./client/state/reader/sites/selectors.js"),k=s("./client/state/reader/feeds/selectors.js"),P=s("./client/components/data/query-reader-site/index.jsx"),S=o(P),w=s("./client/components/data/query-reader-feed/index.jsx"),I=o(w),C=s("./client/lib/feed-post-store/index.js"),E=o(C),R=s("./client/lib/react-smart-set-state/index.js"),M=o(R),N=s("./client/reader/stats.js"),L=s("./client/reader/discover/helper.js"),T=s("./client/reader/utils.js"),F=function(e){function t(){var e,s,o,r;(0,d.default)(this,t);for(var n=arguments.length,i=Array(n),c=0;c<n;c++)i[c]=arguments[c];return s=o=(0,f.default)(this,(e=t.__proto__||(0,l.default)(t)).call.apply(e,[this].concat(i))),o.onClick=function(e){var t=void 0;(0,v.get)(o.props,"discoverPick.post")&&(t=(0,a.default)({},e,{referral:{blogId:L.discoverBlogId,postId:o.props.post.ID}})),o.props.handleClick&&o.props.handleClick({post:t||e})},o.onCommentClick=function(){(0,N.recordAction)("click_comments"),(0,N.recordGaEvent)("Clicked Post Comment Button"),(0,N.recordTrackForPost)("calypso_reader_post_comments_button_clicked",o.props.post),o.props.handleClick&&o.props.handleClick({post:o.props.post,comments:!0})},r=s,(0,f.default)(o,r)}return(0,h.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=this.props.post,t=e.feed_ID,s=e.site_ID,o=e.is_external,r=e.is_discover,a=void 0;if(r){var n=(0,L.getSourceData)(this.props.post),l=n.blogId;a=l}return g.default.createElement(j.default,{post:this.props.post,discoverPick:this.props.discoverPick,site:this.props.site,feed:this.props.feed,onClick:this.onClick,onCommentClick:this.onCommentClick,isSelected:this.props.isSelected,showPrimaryFollowButton:this.props.showPrimaryFollowButtonOnCards,followSource:this.props.followSource,showSiteName:this.props.showSiteName,isDiscoverStream:this.props.isDiscoverStream,postKey:this.props.postKey,compact:this.props.compact},t&&g.default.createElement(I.default,{feedId:t,includeMeta:!1}),!o&&s&&g.default.createElement(S.default,{siteId:+s,includeMeta:!1}),a&&g.default.createElement(S.default,{siteId:a,includeMeta:!1}))}}]),t}(g.default.Component);F.displayName="ReaderPostCardAdapter";var D=(0,b.connect)(function(e,t){var s=(0,v.get)(t,"post.site_ID"),o=(0,v.get)(t,"post.is_external"),r=(0,v.get)(t,"post.feed_ID"),a=null;if((0,v.get)(t,"post.is_discover")){var n=(0,v.get)(t,"discoverPick.post");if(t.isDiscoverStream){var l=(0,L.getSourceData)(t.post),i=l.blogId,d=i?(0,x.getSite)(e,i):null;(n||d)&&(a={post:n,site:d})}else n&&(a={post:n})}return{site:o?null:(0,x.getSite)(e,s),feed:(0,k.getFeed)(e,r),discoverPick:a}})(F),H=function(e){function t(e){(0,d.default)(this,t);var s=(0,f.default)(this,(t.__proto__||(0,l.default)(t)).call(this,e));return s.updateState=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.getStateFromStores();s.smartSetState(e)},s.state=s.getStateFromStores(e),s.smartSetState=M.default,s}return(0,h.default)(t,e),(0,u.default)(t,[{key:"getStateFromStores",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=e.post,s=t.is_discover&&!(0,L.isDiscoverSitePick)(t),o=null;return s&&(o={post:E.default.get((0,L.getSourceData)(t))}),{discoverPick:o}}},{key:"componentWillMount",value:function(){E.default.on("change",this.updateState)}},{key:"componentWillReceiveProps",value:function(e){this.updateState(this.getStateFromStores(e))}},{key:"componentWillUnmount",value:function(){E.default.off("change",this.updateState)}},{key:"shouldComponentUpdate",value:function(e,t){var s=(0,v.omit)(this.props,"handleClick"),o=(0,v.omit)(e,"handleClick"),r=this.props!==e&&!(0,T.shallowEquals)(s,o)||(0,v.get)(this.state,"discoverPick.post")!==(0,v.get)(t,"discoverPick.post");return r}},{key:"render",value:function(){return g.default.createElement(D,(0,a.default)({},this.props,{discoverPick:this.state.discoverPick}))}}]),t}(g.default.Component);H.displayName="ReaderPostCardAdapterFluxContainer",t.default=H,e.exports=t.default},"./client/reader/stream/recommended-posts.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t,s){(0,C.recordTrackForPost)("calypso_reader_recommended_post_dismissed",s,{recommendation_source:"in-stream",ui_position:e}),(0,C.recordAction)("in_stream_rec_dismiss"),(0,M.dismissPost)(t,s)}function a(e,t){(0,C.recordTrackForPost)("calypso_reader_recommended_site_clicked",t,{recommendation_source:"in-stream",ui_position:e}),(0,C.recordAction)("in_stream_rec_site_click")}function n(e,t){(0,C.recordTrackForPost)("calypso_reader_recommended_post_clicked",t,{recommendation_source:"in-stream",ui_position:e}),(0,C.recordAction)("in_stream_rec_post_click")}Object.defineProperty(t,"__esModule",{value:!0}),t.RecommendedPosts=void 0;var l=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),i=o(l),d=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),c=o(d),u=s("./node_modules/babel-runtime/helpers/createClass.js"),p=o(u),f=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),m=o(f),h=s("./node_modules/babel-runtime/helpers/inherits.js"),_=o(h),g=s("./node_modules/prop-types/index.js"),b=o(g),v=s("./node_modules/react/react.js"),y=o(v),j=s("./node_modules/lodash/lodash.js"),x=s("./node_modules/i18n-calypso/index.js"),k=s("./node_modules/gridicons/build/index.js"),P=o(k),S=s("./client/blocks/reader-related-card-v2/index.jsx"),w=s("./client/lib/feed-post-store/index.js"),I=o(w),C=s("./client/reader/stats.js"),E=s("./client/components/button/index.jsx"),R=o(E),M=s("./client/lib/feed-stream-store/actions.js"),N=t.RecommendedPosts=function(e){
function t(){var e,s,o,r;(0,c.default)(this,t);for(var a=arguments.length,n=Array(a),l=0;l<a;l++)n[l]=arguments[l];return s=o=(0,m.default)(this,(e=t.__proto__||(0,i.default)(t)).call.apply(e,[this].concat(n))),o.state={posts:(0,j.map)(o.props.recommendations,I.default.get.bind(I.default))},o.updatePosts=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.props,t=(0,j.map)(e.recommendations,I.default.get.bind(I.default));(0,j.some)(t,function(e,t){return e!==o.state.posts[t]})&&o.setState({posts:t})},r=s,(0,m.default)(o,r)}return(0,_.default)(t,e),(0,p.default)(t,[{key:"componentWillMount",value:function(){I.default.on("change",this.updatePosts)}},{key:"componentWillReceiveProps",value:function(e){this.updatePosts(e)}},{key:"componentWillUnmount",value:function(){I.default.off("change",this.updatePosts)}},{key:"render",value:function(){var e=this;return y.default.createElement("div",{className:"reader-stream__recommended-posts"},y.default.createElement("h1",{className:"reader-stream__recommended-posts-header"},y.default.createElement(P.default,{icon:"thumbs-up",size:18}),"",this.props.translate("Recommended Posts")),y.default.createElement("ul",{className:"reader-stream__recommended-posts-list"},(0,j.map)(this.state.posts,function(t,s){var o=e.props.index+s;return y.default.createElement("li",{className:"reader-stream__recommended-posts-list-item",key:t.global_ID},y.default.createElement("div",{className:"reader-stream__recommended-post-dismiss"},y.default.createElement(R.default,{borderless:!0,title:e.props.translate("Dismiss this recommendation"),onClick:(0,j.partial)(r,o,e.props.storeId,t)},y.default.createElement(P.default,{icon:"cross",size:14}))),y.default.createElement(S.RelatedPostCard,{post:t,onPostClick:(0,j.partial)(n,o),onSiteClick:(0,j.partial)(a,o),followSource:e.props.followSource}))})))}}]),t}(y.default.PureComponent);N.propTypes={index:b.default.number,translate:b.default.func,recommendations:b.default.array},t.default=(0,x.localize)(N)},"./client/reader/stream/utils.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){return(0,m.isDiscoverBlog)(e.blogId)||(0,m.isDiscoverFeed)(e.feedId)}function a(e,t){return e&&t&&!e.isRecommendationBlock&&!t.isRecommendationBlock&&(e.blogId&&e.blogId===t.blogId||e.feedId&&e.feedId===t.feedId)}function n(e,t){return(0,f.default)(e.date).isSame(t.date,"day")}function l(e,t){if(!e||!t)return null;var s={isCombination:!0,date:e.date&&e.date<t.date?e.date:t.date,postIds:[].concat((0,c.default)(e.postIds||[e.postId]),(0,c.default)(t.postIds||[t.postId]))};return e.blogId&&(s.blogId=e.blogId),e.feedId&&(s.feedId=e.feedId),s}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments[2];if(!t||0===t.length)return e;if(e.length<s)return e;var o=0;return(0,u.flatMap)(e,function(e,r){if(r&&r%s===0&&o<t.length){var a={isRecommendationBlock:!0,recommendations:t.slice(o,o+h),index:o};return o+=h,[a,e]}return e})}Object.defineProperty(t,"__esModule",{value:!0}),t.combineCards=t.RECS_PER_BLOCK=void 0;var d=s("./node_modules/babel-runtime/helpers/toConsumableArray.js"),c=o(d);t.isDiscoverPostKey=r,t.sameSite=a,t.sameDay=n,t.combine=l,t.injectRecommendations=i;var u=s("./node_modules/lodash/lodash.js"),p=s("./node_modules/moment/moment.js"),f=o(p),m=s("./client/reader/discover/helper.js"),h=t.RECS_PER_BLOCK=2;t.combineCards=function(e){return e.reduce(function(e,t){var s=(0,u.last)(e);return a(s,t)&&n(s,t)&&!r(t)?e[e.length-1]=l((0,u.last)(e),t):e.push(t),e},[])}},"./client/reader/stream/x-post.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),a=o(r),n=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/createClass.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/inherits.js"),f=o(p),m=s("./node_modules/prop-types/index.js"),h=o(m),_=s("./node_modules/react/react.js"),g=o(_),b=s("./node_modules/react-dom/index.js"),v=o(b),y=s("./node_modules/classnames/index.js"),j=o(y),x=s("./node_modules/url/url.js"),k=o(x),P=s("./node_modules/i18n-calypso/index.js"),S=s("./node_modules/component-closest/index.js"),w=o(S),I=s("./node_modules/lodash/lodash.js"),C=s("./node_modules/react-redux/es/index.js"),E=s("./client/components/card/index.jsx"),R=o(E),M=s("./client/blocks/reader-avatar/index.jsx"),N=o(M),L=s("./client/state/reader/sites/selectors.js"),T=s("./client/state/reader/feeds/selectors.js"),F=s("./client/components/data/query-reader-site/index.jsx"),D=o(F),H=s("./client/components/data/query-reader-feed/index.jsx"),A=o(H),O=s("./client/components/emojify/index.jsx"),U=o(O),B=function(e){function t(){var e,s,o,r;(0,l.default)(this,t);for(var n=arguments.length,i=Array(n),d=0;d<n;d++)i[d]=arguments[d];return s=o=(0,u.default)(this,(e=t.__proto__||(0,a.default)(t)).call.apply(e,[this].concat(i))),o.handleTitleClick=function(e){e.button>0||e.metaKey||e.controlKey||e.shiftKey||e.altKey||(e.preventDefault(),o.props.handleClick(o.props.xMetadata))},o.handleCardClick=function(e){var t=v.default.findDOMNode(o);(0,w.default)(e.target,".should-scroll",!0,t)&&setTimeout(function(){window.scrollTo(0,0)},100),(0,w.default)(e.target,".ignore-click",!0,t)||(0,w.default)(e.target,"a",!0,t)&&(0,w.default)(e.target,".reader__x-post",!0,t)||e.metaKey||e.controlKey||e.shiftKey||e.altKey||e.defaultPrevented||(e.preventDefault(),o.props.handleClick(o.props.xMetadata))},o.getSiteNameFromURL=function(e){return e&&"+"+k.default.parse(e).hostname.split(".")[0]},o.getDescription=function(e){var t=void 0,s=o.getSiteNameFromURL(o.props.xMetadata.siteURL),r=!!o.props.xMetadata.commentURL;return t=r?o.props.translate("{{author}}%(authorFirstName)s{{/author}} {{label}}left a comment on %(siteName)s, cross-posted to{{/label}} {{blogNames/}}",{args:{siteName:s,authorFirstName:e},components:{author:g.default.createElement("span",{className:"reader__x-post-author"}),label:g.default.createElement("span",{className:"reader__x-post-label"}),blogNames:o.getXPostedToContent()}}):o.props.translate("{{author}}%(authorFirstName)s{{/author}} {{label}}cross-posted from %(siteName)s to{{/label}} {{blogNames/}}",{args:{siteName:s,authorFirstName:e},components:{author:g.default.createElement("span",{className:"reader__x-post-author"}),label:g.default.createElement("span",{className:"reader__x-post-label"}),blogNames:o.getXPostedToContent()}})},o.getXPostedToContent=function(){var e=o.props.xPostedTo;return e&&0!==e.length||(e=[{siteURL:o.props.post.site_URL,siteName:o.getSiteNameFromURL(o.props.post.site_URL)}]),e.map(function(e,t,s){return g.default.createElement("span",{className:"reader__x-post-site",key:e.siteURL+"-"+t},e.siteName,t+2<s.length&&g.default.createElement("span",null,", "),t+2===s.length&&g.default.createElement("span",null," ",o.props.translate("and",{comment:"last conjunction in a list of blognames: (blog1, blog2,) blog3 _and_ blog4"})," "))})},r=s,(0,u.default)(o,r)}return(0,f.default)(t,e),(0,d.default)(t,[{key:"render",value:function(){var e=this.props,t=e.post,s=e.postKey,o=e.site,r=e.feed,a=e.translate,n=s.blogId,l=s.feedId,i=(0,I.get)(o,"icon.img"),d=(0,I.get)(r,"image"),c=(0,j.default)({reader__card:!0,"is-x-post":!0,"is-selected":this.props.isSelected}),u=t.title;return u=u.replace(/x-post:/i,""),u||(u="("+a("no title")+")"),g.default.createElement(R.default,{tagName:"article",onClick:this.handleCardClick,className:c},g.default.createElement(N.default,{siteIcon:i,feedIcon:d,author:t.author,onClick:this.handleTitleClick,isCompact:!0}),g.default.createElement("div",{className:"reader__x-post"},t.title&&g.default.createElement("h1",{className:"reader__post-title"},g.default.createElement("a",{className:"reader__post-title-link",onClick:this.handleTitleClick,href:t.URL,target:"_blank",rel:"noopener noreferrer"},g.default.createElement(U.default,null,u))),g.default.createElement(U.default,null,this.getDescription(t.author.first_name))),l&&g.default.createElement(A.default,{feedId:+l,includeMeta:!1}),n&&g.default.createElement(D.default,{siteId:+n,includeMeta:!1}))}}]),t}(_.PureComponent);B.propTypes={post:h.default.object.isRequired,isSelected:h.default.bool.isRequired,xMetadata:h.default.object.isRequired,xPostedTo:h.default.array,handleClick:h.default.func.isRequired,translate:h.default.func.isRequired,postKey:h.default.object,site:h.default.object,feed:h.default.object},t.default=(0,C.connect)(function(e,t){var s=t.postKey,o=s.feedId,r=s.blogId,a=void 0,n=void 0;return o?(a=(0,T.getFeed)(e,o),n=a&&a.blog_ID?(0,L.getSite)(e,a.blog_ID):void 0):(n=(0,L.getSite)(e,r),a=n&&n.feed_ID?(0,T.getFeed)(e,n.feed_ID):void 0),{feed:a,site:n}})((0,P.localize)(B)),e.exports=t.default},"./client/reader/tag-stream/controller.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.tagListing=void 0;var r=s("./node_modules/react/react.js"),a=o(r),n=s("./node_modules/lodash/lodash.js"),l=s("./client/lib/feed-stream-store/index.js"),i=o(l),d=s("./client/reader/stats.js"),c=s("./client/reader/controller-helper.js"),u=s("./client/lib/react-helpers/index.js"),p=s("./client/components/async-load/index.jsx"),f=o(p),m=s("./client/reader/follow-button/follow-sources.jsx"),h="Reader",_=function(e){s.e("async-load-reader-tag-stream-main").then(function(t){e(s("./client/reader/tag-stream/main.jsx").__esModule?s("./client/reader/tag-stream/main.jsx").default:s("./client/reader/tag-stream/main.jsx"))}.bind(null,s)).catch(s.oe)};t.tagListing=function(e){var t="/tag/:slug",s=h+" > Tag > "+e.params.tag,o=(0,n.trim)(e.params.tag).toLowerCase().replace(/\s+/g,"-").replace(/-{2,}/g,"-"),r=encodeURIComponent(o).toLowerCase(),l=(0,i.default)("tag:"+o),p="topic";(0,c.ensureStoreLoading)(l,e),(0,c.trackPageLoad)(t,s,p),(0,d.recordTrack)("calypso_reader_tag_loaded",{tag:o}),(0,u.renderWithReduxStore)(a.default.createElement(f.default,{require:_,key:"tag-"+r,postsStore:l,encodedTagSlug:r,decodedTagSlug:o,trackScrollPage:c.trackScrollPage.bind(null,t,s,h,p),onUpdatesShown:c.trackUpdatesLoaded.bind(null,p),showBack:!!e.lastRoute,showPrimaryFollowButtonOnCards:!0,followSource:m.TAG_PAGE}),document.getElementById("primary"),e.store)}},"./client/reader/tag-stream/index.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){(0,a.default)("/tag/*",l.preloadReaderBundle,l.initAbTests),(0,a.default)("/tag/:tag",l.updateLastRoute,l.sidebar,n.tagListing)};var r=s("./node_modules/page/index.js"),a=o(r),n=s("./client/reader/tag-stream/controller.js"),l=s("./client/reader/controller.js");e.exports=t.default},"./client/reader/update-notice/index.jsx":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=s("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),a=o(r),n=s("./node_modules/babel-runtime/helpers/classCallCheck.js"),l=o(n),i=s("./node_modules/babel-runtime/helpers/createClass.js"),d=o(i),c=s("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),u=o(c),p=s("./node_modules/babel-runtime/helpers/inherits.js"),f=o(p),m=s("./node_modules/prop-types/index.js"),h=o(m),_=s("./node_modules/react/react.js"),g=o(_),b=s("./node_modules/i18n-calypso/index.js"),v=s("./node_modules/react-redux/es/index.js"),y=s("./node_modules/lodash/lodash.js"),j=s("./node_modules/classnames/index.js"),x=o(j),k=s("./node_modules/gridicons/build/index.js"),P=o(k),S=s("./client/components/data/document-head/index.jsx"),w=o(S),I=s("./client/state/document-head/selectors.js"),C=function(e){function t(){var e,s,o,r;(0,l.default)(this,t);for(var n=arguments.length,i=Array(n),d=0;d<n;d++)i[d]=arguments[d];return s=o=(0,u.default)(this,(e=t.__proto__||(0,a.default)(t)).call.apply(e,[this].concat(i))),o.handleClick=function(e){e.preventDefault(),o.props.onClick()},r=s,(0,u.default)(o,r)}return(0,f.default)(t,e),(0,d.default)(t,[{key:"render",value:function(){var e=(0,x.default)({"reader-update-notice":!0,"is-active":this.props.count>0});return g.default.createElement("div",{className:e,onClick:this.handleClick},g.default.createElement(w.default,{unreadCount:this.props.count}),g.default.createElement(P.default,{icon:"arrow-up",size:18}),this.props.translate("%s new post","%s new posts",{args:[this.props.cappedUnreadCount],count:this.props.count}))}}]),t}(g.default.PureComponent);C.propTypes={count:h.default.number.isRequired,onClick:h.default.func,cappedUnreadCount:h.default.string},C.defaultProps={onClick:y.noop},t.default=(0,v.connect)(function(e){return{cappedUnreadCount:(0,I.getDocumentHeadCappedUnreadCount)(e)}})((0,b.localize)(C)),e.exports=t.default},"./client/reader/utils.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){return e.button>0||e.metaKey||e.controlKey||e.shiftKey||e.altKey}function a(e){return void 0!==e&&404===e.statusCode}function n(e){var t=e.store,s=e.replaceHistory,o=e.postKey,r=e.comments;if(o){if((0,v.setLastStoreId)(t&&t.id),o.isGap===!0)return i(o,t.id);if(!o.isRecommendationBlock){var a=_.default.get(o);if((0,g.isXPost)(a)&&!s)return l(b.default.getXPostMetadata(a));var n=void 0;n=o.feedId?{feed_ID:o.feedId,feed_item_ID:o.postId}:{site_ID:o.blogId,ID:o.postId},d({post:n,replaceHistory:s,comments:r})}}}function l(e){if(e.blogId&&e.postId){var t={site_ID:e.blogId,ID:e.postId};d({post:t})}else window.open(e.postURL)}function i(e,t){e&&e.isGap&&t&&((0,y.fillGap)(t,e),(0,j.recordAction)("fill_gap"),(0,j.recordGaEvent)("Clicked Fill Gap"),(0,j.recordTrack)("calypso_reader_filled_gap",{stream:t}))}function d(e){var t=e.post,s=e.replaceHistory,o=e.comments,r=o?"#comments":"",a="";if(t.referral){var n=t.referral,l=n.blogId,i=n.postId;a+="ref_blog="+l+"&ref_post="+i}var d=s?"replace":"show";t.feed_ID&&t.feed_item_ID?f.default[d]("/read/feeds/"+t.feed_ID+"/posts/"+t.feed_item_ID+r+a):f.default[d]("/read/blogs/"+t.site_ID+"/posts/"+t.ID+r+a)}Object.defineProperty(t,"__esModule",{value:!0}),t.shallowEquals=void 0;var c=s("./node_modules/babel-runtime/core-js/object/keys.js"),u=o(c);t.isSpecialClick=r,t.isPostNotFound=a,t.showSelectedPost=n,t.showFullXPost=l,t.handleGapClicked=i,t.showFullPost=d;var p=s("./node_modules/page/index.js"),f=o(p),m=s("./node_modules/lodash/lodash.js"),h=s("./client/lib/feed-post-store/index.js"),_=o(h),g=s("./client/reader/xpost-helper.js"),b=o(g),v=s("./client/reader/controller-helper.js"),y=s("./client/lib/feed-stream-store/actions.js"),j=s("./client/reader/stats.js");t.shallowEquals=function(e,t){return(0,m.every)((0,u.default)(e),function(s){return e[s]===t[s]})}},"./client/reader/xpost-helper.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){return e&&e.display_type&d.X_POST}Object.defineProperty(t,"__esModule",{value:!0}),t.getXPostMetadata=void 0;var a=s("./node_modules/babel-runtime/core-js/object/keys.js"),n=o(a);t.isXPost=r;var l=s("./node_modules/url/url.js"),i=o(l),d=s("./client/lib/feed-post-store/display-types.js"),c={getXPostMetadata:function(e){var t={siteURL:null,postURL:null,commentURL:null,blogId:null,postId:null};if(e&&e.metadata)for(var s=(0,n.default)(e.metadata),o=0;o<s.length;o++){var r=e.metadata[s[o]];if("_xpost_original_permalink"===r.key||"xcomment_original_permalink"===r.key){var a=i.default.parse(r.value,!1,!1);t.siteURL=a.protocol+"//"+a.host,t.postURL=""+t.siteURL+a.path,a.hash&&0===a.hash.indexOf("#comment-")&&(t.commentURL=a.href)}else if("xpost_origin"===r.key){var l=r.value.split(":");t.blogId=l[0],t.postId=l[1]}}return t}};t.default=c;var u=c.getXPostMetadata;t.getXPostMetadata=u},"./client/state/reader/posts/selectors.js":function(e,t,s){"use strict";function o(e,t){return e.reader.posts.items[t]}function r(e,t,s){if(e.reader.posts.items!==n){var o=e.reader.posts.items,r=(0,a.filter)(o,function(e){return e&&e.site_ID&&e.ID&&!e.is_external});l=(0,a.keyBy)(r,function(e){return e.site_ID+"-"+e.ID}),n=o}return l[t+"-"+s]}Object.defineProperty(t,"__esModule",{value:!0}),t.getPost=o,t.getPostBySiteAndId=r;var a=s("./node_modules/lodash/lodash.js"),n=null,l={}},"./node_modules/babel-runtime/helpers/toArray.js":function(e,t,s){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var r=s("./node_modules/babel-runtime/core-js/array/from.js"),a=o(r);t.default=function(e){return Array.isArray(e)?e:(0,a.default)(e)}}});