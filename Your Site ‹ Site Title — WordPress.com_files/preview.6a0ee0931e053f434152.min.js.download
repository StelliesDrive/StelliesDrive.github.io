webpackJsonp(["preview"],{"./client/my-sites/preview/controller.js":function(e,t,n){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n("./node_modules/react/react.js"),l=s(i),o=n("./client/my-sites/preview/main.jsx"),a=s(o);t.default={preview:function(e,t){e.primary=l.default.createElement(a.default,{site:e.params.site}),t()}},e.exports=t.default},"./client/my-sites/preview/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e("/view",i.siteSelection,i.sites),e("/view/:site",i.siteSelection,i.makeNavigation,l.preview,s.makeLayout)};var s=n("./client/controller/index.web.js"),i=n("./client/my-sites/controller.js"),l=n("./client/my-sites/preview/controller.js");e.exports=t.default},"./client/my-sites/preview/main.jsx":function(e,t,n){"use strict";(function(s){function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=n("./node_modules/babel-runtime/core-js/object/get-prototype-of.js"),o=i(l),a=n("./node_modules/babel-runtime/helpers/classCallCheck.js"),r=i(a),u=n("./node_modules/babel-runtime/helpers/createClass.js"),d=i(u),c=n("./node_modules/babel-runtime/helpers/possibleConstructorReturn.js"),p=i(c),f=n("./node_modules/babel-runtime/helpers/inherits.js"),m=i(f),v=n("./node_modules/react-redux/es/index.js"),h=n("./node_modules/i18n-calypso/index.js"),w=n("./node_modules/lodash/lodash.js"),y=n("./node_modules/react/react.js"),b=i(y),j=n("./node_modules/debug/browser.js"),_=i(j),x=n("./client/state/ui/selectors.js"),U=n("./client/state/sites/selectors.js"),g=n("./client/lib/route/add-query-args.js"),L=i(g),S=n("./client/state/ui/layout-focus/actions.js"),k=n("./client/lib/viewport/index.js"),C=n("./client/components/button/index.jsx"),E=i(C),P=n("./client/components/data/document-head/index.jsx"),M=i(P),O=n("./client/components/empty-content/index.jsx"),I=i(O),R=n("./node_modules/gridicons/build/index.js"),W=i(R),z=n("./client/components/main/index.jsx"),B=i(z),F=n("./client/components/web-preview/content.jsx"),N=i(F),D=(0,_.default)("calypso:my-sites:preview"),q=function(e){function t(){var e,n,s,i;(0,r.default)(this,t);for(var l=arguments.length,a=Array(l),u=0;u<l;u++)a[u]=arguments[u];return n=s=(0,p.default)(this,(e=t.__proto__||(0,o.default)(t)).call.apply(e,[this].concat(a))),s.state={previewUrl:null,externalUrl:null,showingClose:!1},s.updateLayout=function(){s.setState({showingClose:(0,k.isWithinBreakpoint)("<660px")})},s.debouncedUpdateLayout=(0,w.debounce)(s.updateLayout,50),s.updateSiteLocation=function(e){s.setState({externalUrl:s.props.site.URL+("/"===e?"":e)})},s.focusSidebar=function(){s.props.setLayoutFocus("sidebar")},i=n,(0,p.default)(s,i)}return(0,m.default)(t,e),(0,d.default)(t,[{key:"componentWillMount",value:function(){this.updateUrl(),this.updateLayout()}},{key:"componentDidMount",value:function(){s.window&&s.window.addEventListener("resize",this.debouncedUpdateLayout)}},{key:"componentWillUnmount",value:function(){s.window&&s.window.removeEventListener("resize",this.debouncedUpdateLayout)}},{key:"updateUrl",value:function(){if(!this.props.site)return void(null!==this.state.previewUrl&&(D("unloaded page"),this.setState({previewUrl:null,externalUrl:null})));var e=this.getBasePreviewUrl(),t=(0,L.default)({theme_preview:!0,iframe:!0,"frame-nonce":this.props.site.options.frame_nonce},e);this.iframeUrl!==t&&(D("loading",t),this.setState({previewUrl:t,externalUrl:this.props.site.URL}))}},{key:"getBasePreviewUrl",value:function(){return this.props.site.options.unmapped_url}},{key:"componentDidUpdate",value:function(e){this.props.siteId!==e.siteId&&(D("site change detected"),this.updateUrl())}},{key:"render",value:function(){var e=this.props,t=e.translate,n=e.isPreviewable,s=e.site;if(!s)return null;if(!n){var i=b.default.createElement(E.default,{primary:!0,icon:!0,href:s.URL,target:"_blank"},t("Open")," ",b.default.createElement(W.default,{icon:"external"}));return b.default.createElement(I.default,{title:t("Unable to show your site here"),line:t("To view your site, click the button below"),action:i,illustration:"/calypso/images/illustrations/illustration-404.svg",illustrationWidth:350})}return b.default.createElement(B.default,{className:"preview"},b.default.createElement(M.default,{title:t("Your Site")}),b.default.createElement(N.default,{onLocationUpdate:this.updateSiteLocation,showUrl:!!this.state.externalUrl,showClose:this.state.showingClose,onClose:this.focusSidebar,previewUrl:this.state.previewUrl,externalUrl:this.state.externalUrl,loadingMessage:this.props.translate("{{strong}}One moment, pleaseâ€¦{{/strong}} loading your site.",{components:{strong:b.default.createElement("strong",null)}})}))}}]),t}(b.default.Component);q.displayName="Preview";var A=function(e){var t=(0,x.getSelectedSiteId)(e);return{isPreviewable:(0,U.isSitePreviewable)(e,t),site:(0,x.getSelectedSite)(e),siteId:t}};t.default=(0,v.connect)(A,{setLayoutFocus:S.setLayoutFocus})((0,h.localize)(q)),e.exports=t.default}).call(t,n("./node_modules/webpack/buildin/global.js"))}});